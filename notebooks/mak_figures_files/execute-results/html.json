{
  "hash": "1af2d3516d0c8edc3a0900b3f9030cde",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Make Figures for Main Manuscript\"\nauthor: \"Lauren Khoury\"\ndate: \"2025-10-15\"\nnumber-sections: true\noutput: \n  html_document:\n    toc: true \n    toc_depth: 4\nformat:\n  html:\n    embed-resources: true\n    toc: true\n    toc-depth: 4\neditor_options: \n  chunk_output_type: console\nexecute:\n  echo: false\nhtml-table-processing: none\n---\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(dplyr) |> suppressMessages()\nlibrary(skimr)\nlibrary(purrr)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(cowplot)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'cowplot'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following object is masked from 'package:patchwork':\n\n    align_plots\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(forcats)\nlibrary(kableExtra, exclude = (\"group_rows\"))\n\ntheme_set(theme_classic())\nmethod_colors <- c(\"No covariates\" = \"sienna\",\n                   \"All covariates\" = \"goldenrod2\",\n                   \"p-hacking\" = \"red2\",\n                   \"Bivariate correlation\" = \"springgreen3\",\n                   \"Partial correlation\" = \"deepskyblue\",\n                   \"Full linear model\" = \"mediumpurple1\",\n                   \"Full linear model with X\" = \"slateblue1\",\n                   \"LASSO\" = \"hotpink\",\n                   \"LASSO with X\" = \"lightpink\")\nmethod_linetypes <- c(\"No covariates\" = \"solid\",\n                      \"All covariates\" = \"solid\",\n                      \"p-hacking\" = \"longdash\",\n                      \"Bivariate correlation\" = \"dashed\",\n                      \"Partial correlation\" = \"twodash\",\n                      \"Full linear model\" = \"dashed\",\n                      \"Full linear model with X\" = \"twodash\",\n                      \"LASSO\" = \"dashed\",\n                      \"LASSO with X\" = \"twodash\")\n\ndevtools::source_url(\"https://github.com/jjcurtin/lab_support/blob/main/format_path.R?raw=true\") |> suppressMessages()\n\n# rdrive_path <- format_path(\"studydata/cov/raw_data\")\nrdrive_path <- \"\\\\\\\\research.drive.wisc.edu\\\\jjcurtin\\\\studydata\\\\cov\\\\raw_data\"\nsetwd(rdrive_path)\n\noptions(digits = 3)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: read in data\n\nd_0 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_method_0.csv\"))\nd_03 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_method_03.csv\"))\nd_05 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_method_05.csv\"))\n\nd_20_covs <- data.table::fread(here::here(rdrive_path, \"batch_results_20_covs.csv\"))\nd_n50 <- data.table::fread(here::here(rdrive_path, \"batch_results_n50.csv\"))\n\nd2_0 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_20K_0.csv\"))\nd2_03 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_20K_03.csv\"))\nd2_05 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_20K_05.csv\"))\n\nd_wo_x_og <- data.table::fread(here::here(rdrive_path, \"batch_results_methods_wo_x_og_seed.csv\"))\nd_wo_x_new <- data.table::fread(here::here(rdrive_path, \"batch_results_methods_wo_x_new_seed.csv\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: combine data\n\nd_0 <- rbind(d_0, d_20_covs |> filter(b_x == 0))\nd_03 <- rbind(d_03, d_20_covs |> filter(b_x == 0.3))\nd_05 <- rbind(d_05, d_20_covs |> filter(b_x == 0.5))\n\nd_0 <- rbind(d_0, d_n50 |> filter(b_x == 0))\nd_03 <- rbind(d_03, d_n50 |> filter(b_x == 0.3))\nd_05 <- rbind(d_05, d_n50 |> filter(b_x == 0.5))\n\nd_0 <- rbind(d_0, d2_0)\nd_03 <- rbind(d_03, d2_03)\nd_05 <- rbind(d_05, d2_05)\n\nd_0 <- rbind(d_0, d_wo_x_og |> filter(b_x == 0))\nd_0 <- rbind(d_0, d_wo_x_new |> filter(b_x == 0))\nd_03 <- rbind(d_03, d_wo_x_og |> filter(b_x == 0.3))\nd_03 <- rbind(d_03, d_wo_x_new |> filter(b_x == 0.3))\nd_05 <- rbind(d_05, d_wo_x_og |> filter(b_x == 0.5))\nd_05 <- rbind(d_05, d_wo_x_new |> filter(b_x == 0.5))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: factor levels\n\nd_0 <- d_0 |> \n  mutate(method = factor(method, levels = c(\"no_covs\", \"all_covs\", \"p_hacked\", \"r\", \n                                            \"partial_r\", \"full_lm_wo_x\", \"full_lm\",  \n                                           \"lasso_wo_x\", \"lasso\"),\n                         labels = c(\"No covariates\", \"All covariates\", \"p-hacking\", \n                                    \"Bivariate correlation\", \"Partial correlation\", \n                                    \"Full linear model\", \"Full linear model with X\", \n                                            \"LASSO\", \"LASSO with X\")))\n\nd_03 <- d_03 |> \n  mutate(method = factor(method, levels = c(\"no_covs\", \"all_covs\", \"p_hacked\", \"r\", \n                                            \"partial_r\", \"full_lm_wo_x\", \"full_lm\",  \n                                           \"lasso_wo_x\", \"lasso\"),\n                         labels = c(\"No covariates\", \"All covariates\", \"p-hacking\", \n                                    \"Bivariate correlation\", \"Partial correlation\", \n                                    \"Full linear model\", \"Full linear model with X\", \n                                            \"LASSO\", \"LASSO with X\")))\n\nd_05 <- d_05 |> \n  mutate(method = factor(method, levels = c(\"no_covs\", \"all_covs\", \"p_hacked\", \"r\", \n                                            \"partial_r\", \"full_lm_wo_x\", \"full_lm\",  \n                                           \"lasso_wo_x\", \"lasso\"),\n                         labels = c(\"No covariates\", \"All covariates\", \"p-hacking\", \n                                    \"Bivariate correlation\", \"Partial correlation\", \n                                    \"Full linear model\", \"Full linear model with X\", \n                                            \"LASSO\", \"LASSO with X\")))\n```\n:::\n\n::: {#cell-fig-typeI-bar .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeI-bar\n#| fig-cap: \"Type I Error by Method. Average type I error rate across all research settings is displayed for each method separately by color. The horizontal dotted black line indicates expected Type 1 Error rate for an alpha = .05.\"\n\ntype_I_summary <- d_0 |>\n  group_by(method) |>\n  summarise(type_I = mean(p_value < 0.05))\n\ntype_I_summary |> \n  mutate(method = fct_relevel(method, \"p-hacking\")) |>\n  ggplot(aes(x = method, y = type_I, fill = method)) +\n  geom_bar(stat = \"identity\") +\n  geom_hline(yintercept = 0.05, linetype = \"dotted\", color = \"black\", linewidth = .75) +\n  geom_text(aes(label = sprintf(\"%.3f\", type_I)), vjust = -0.5) +\n  labs(x = NULL,\n       y = \"Type I Error\",\n       fill = \"Method\") +\n  scale_y_continuous(limits = c(0, max(type_I_summary$type_I) * 1.2), \n                     breaks = seq(0, max(type_I_summary$type_I) * 1.2, by = 0.05)) +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_fill_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type I Error by Method. Average type I error rate across all research settings is displayed for each method separately by color. The horizontal dotted black line indicates expected Type 1 Error rate for an alpha = .05.](mak_figures_files/figure-html/fig-typeI-bar-1.png){#fig-typeI-bar width=672}\n:::\n:::\n\n\n\n\n<!--add to figure legends: Note that for the line plots throughout this report, a solid line will indicate a method that does not involve performing selection of covariates (i.e., using no or all covariates). A dashed line will indicate a method that does involve performing a non-trivial selection of covariates. A dotted black line will indicate the expected value (if applicable). For example, there will be a dotted line at $\\alpha = 0.05$, the signifance level considered here and hence, the expected Type I error rate.-->\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nobservations <- d_0 |> \n  group_by(method, n_obs) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_obs, y = prop_sig, color = method, linetype = method)) + \n  geom_line() +\n  geom_hline(yintercept = 0.05, linetype = \"dotted\", color = \"black\") +\n  scale_x_continuous(breaks = c(50, 100, 150, 200, 300, 400)) +\n  scale_y_continuous(breaks = c(0.05, 0.10, 0.15, 0.20, .25, .30),\n                     limits = c(0.03, .30)) +\n  labs(x = NULL,\n       subtitle = \"Number of Observations\",\n       y = \"Type I Error\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) +\n  theme(legend.title = element_blank())\n\n\ncovs <- d_0 |> \n  group_by(method, n_covs) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_covs, y = prop_sig, color = method, linetype = method)) + \n  geom_line() +\n  geom_hline(yintercept = 0.05, linetype = \"dotted\", color = \"black\") +\n  scale_x_continuous(breaks = c(4, 8, 12, 16, 20)) +\n  scale_y_continuous(breaks = c(0.05, 0.10, 0.15, 0.20, 0.25, .30),\n                     limits = c(.03, .30)) +\n  labs(y = \"Type I Error\",\n       x = NULL,\n       subtitle = \"Number of Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) +\n  theme(legend.title = element_blank())\n\ngood_covs <- d_0 |> \n  group_by(method, p_good_covs) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = p_good_covs, y = prop_sig, color = method, linetype = method)) + \n  geom_line() +\n  geom_hline(yintercept = 0.05, linetype = \"dotted\", color = \"black\") +\n  scale_x_continuous(breaks = c(0.25, 0.50, 0.75)) +\n  scale_y_continuous(breaks = c(0.05, 0.10, 0.15, 0.20, .25, .30), \n                     limits = c(.03, .30)) +\n  labs(y = \"Type I Error\",\n       x = NULL,\n       subtitle = \"Proportion of Good Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) +\n  theme(legend.title = element_blank())\n\nycor <- d_0 |> \n  group_by(method, r_ycov) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = r_ycov, y = prop_sig, color = method, linetype = method)) + \n  geom_line() +\n  geom_hline(yintercept = 0.05, linetype = \"dotted\", color = \"black\") +\n  scale_x_continuous(breaks = c(0.3, 0.5)) +\n  scale_y_continuous(breaks = c(0.05, 0.10, 0.15, 0.20, 0.25, 0.30), \n                     limits = c(.03, .30)) +\n  labs(y = \"Type I Error\",\n       x = NULL,\n       subtitle = \"Y-Covariate Correlation\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) +\n  theme(legend.title = element_blank())\n```\n:::\n\n::: {#cell-fig-type1-panel .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-type1-panel\n#| fig-cap:\n#| fig-height: 8\n#| fig-width: 7\n\n(observations + covs)/(good_covs + ycor) +\n  plot_layout(guides = \"collect\") &\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](mak_figures_files/figure-html/fig-type1-panel-1.png){#fig-type1-panel width=672}\n:::\n:::\n\n::: {#cell-fig-distribution-bx-0 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-distribution-bx-0\n#| fig-cap: \"Sampling Distribution for b_x=0 Estimate\"\n\nd_0 |> \n  ggplot(aes(x = estimate, color = method, linetype = method)) +\n  geom_density(alpha = 0.5) +\n  geom_vline(xintercept = 0, linetype = \"dotted\", color = \"black\") +\n  scale_x_continuous(limits = c(-0.5, 0.5), breaks = seq(-0.5, 0.5, by = 0.5)) +\n  labs(y = \"Density\",\n       x = \"Estimate\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) \n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 798111 rows containing non-finite outside the scale range\n(`stat_density()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Sampling Distribution for b_x=0 Estimate](mak_figures_files/figure-html/fig-distribution-bx-0-1.png){#fig-distribution-bx-0 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-bar-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-bar-03\n#| fig-cap: \"Type II Error by Method, b_x=0.3\"\n\ntype_II_summary_03 <- d_03 |>\n  filter(method != \"p_hacked\") |> \n  group_by(method) |>\n  summarise(type_II = mean(p_value >= 0.05))\n\ntype_II_summary_03 |> \nggplot(aes(x = method, y = type_II, fill = method)) +\n  geom_bar(stat = \"identity\") +\n  geom_text(aes(label = sprintf(\"%.3f\", type_II)), vjust = -0.5) +\n  labs(x = \"Method\",\n       y = \"Type II Error\",\n       fill = \"Method\") +\n  scale_y_continuous(limits = c(0, max(type_II_summary_03$type_II) * 1.2), \n                     breaks = seq(0, max(type_II_summary_03$type_II) * 1.2, by = 0.05)) +\n  theme_minimal() +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_fill_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Method, b_x=0.3](mak_figures_files/figure-html/fig-typeII-bar-03-1.png){#fig-typeII-bar-03 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-bar-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-bar-05\n#| fig-cap: \"Type II Error by Method, b_x=0.5\"\n\ntype_II_summary_05 <- d_05 |>\n  filter(method != \"p_hacked\") |> \n  group_by(method) |>\n  summarise(type_II = mean(p_value >= 0.05))\n\ntype_II_summary_05 |> \nggplot(aes(x = method, y = type_II, fill = method)) +\n  geom_bar(stat = \"identity\") +\n  geom_text(aes(label = sprintf(\"%.3f\", type_II)), vjust = -0.5) +\n  labs(x = \"Method\",\n       y = \"Type II Error\",\n       fill = \"Method\") +\n  scale_y_continuous(limits = c(0, max(type_II_summary_05$type_II) * 1.2), \n                     breaks = seq(0, max(type_II_summary_05$type_II) * 1.2, by = 0.05)) +\n  theme_minimal() +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_fill_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Method, b_x=0.5](mak_figures_files/figure-html/fig-typeII-bar-05-1.png){#fig-typeII-bar-05 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-nobs-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-nobs-03\n#| fig-cap: \"Type II Error by Number of Observations, b_x=0.3\"\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, n_obs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_obs, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(50, 100, 150, 200, 300, 400)) +\n  labs(y = \"Type II Error\",\n       x = \"Number of Observations\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Number of Observations, b_x=0.3](mak_figures_files/figure-html/fig-typeII-nobs-03-1.png){#fig-typeII-nobs-03 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-nobs-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-nobs-05\n#| fig-cap: \"Type II Error by Number of Observations, b_x=0.5\"\n\nd_05 |> \n  filter(method != \"p_hacked\") |>\n  group_by(method, n_obs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_obs, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(50, 100, 150, 200, 300, 400)) +\n  labs(y = \"Type II Error\",\n       x = \"Number of Observations\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Number of Observations, b_x=0.5](mak_figures_files/figure-html/fig-typeII-nobs-05-1.png){#fig-typeII-nobs-05 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-ncovs-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-ncovs-03\n#| fig-cap: \"Type II Error by Number of Covariates, b_x=0.3\"\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, n_covs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_covs, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(4, 8, 12, 16, 20)) +\n  labs(y = \"Type II Error\",\n       x = \"Number of Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Number of Covariates, b_x=0.3](mak_figures_files/figure-html/fig-typeII-ncovs-03-1.png){#fig-typeII-ncovs-03 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-ncovs-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-ncovs-05\n#| fig-cap: \"Type II Error by Number of Covariates, b_x=0.5\"\n\nd_05 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, n_covs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_covs, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(4, 8, 12, 16, 20)) +\n  labs(y = \"Type II Error\",\n       x = \"Number of Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Number of Covariates, b_x=0.5](mak_figures_files/figure-html/fig-typeII-ncovs-05-1.png){#fig-typeII-ncovs-05 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-pgoodcovs-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-pgoodcovs-03\n#| fig-cap: \"Type II Error by Proportion of Good Covariates, b_x=0.3\"\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, p_good_covs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = p_good_covs, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(0.25, 0.50, 0.75)) +\n  labs(y = \"Type II Error\",\n       x = \"Proportion of Good Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Proportion of Good Covariates, b_x=0.3](mak_figures_files/figure-html/fig-typeII-pgoodcovs-03-1.png){#fig-typeII-pgoodcovs-03 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-pgoodcovs-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-pgoodcovs-05\n#| fig-cap: \"Type II Error by Proportion of Good Covariates, b_x=0.5\"\n\nd_05 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, p_good_covs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = p_good_covs, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(0.25, 0.50, 0.75)) +\n  labs(y = \"Type II Error\",\n       x = \"Proportion of Good Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Proportion of Good Covariates, b_x=0.5](mak_figures_files/figure-html/fig-typeII-pgoodcovs-05-1.png){#fig-typeII-pgoodcovs-05 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-rycov-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-rycov-03\n#| fig-cap: \"Type II Error by Y-Covariate Correlation, b_x=0.3\"\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, r_ycov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = r_ycov, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(0.3, 0.5)) +\n  labs(y = \"Type II Error\",\n       x = \"Y-Covariate Correlation\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Y-Covariate Correlation, b_x=0.3](mak_figures_files/figure-html/fig-typeII-rycov-03-1.png){#fig-typeII-rycov-03 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-rycov-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-rycov-05\n#| fig-cap: \"Type II Error by Y-Covariate Correlation, b_x=0.5\"\n\nd_05 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, r_ycov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = r_ycov, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(0.3, 0.5)) +\n  labs(y = \"Type II Error\",\n       x = \"Y-Covariate Correlation\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Y-Covariate Correlation, b_x=0.5](mak_figures_files/figure-html/fig-typeII-rycov-05-1.png){#fig-typeII-rycov-05 width=672}\n:::\n:::\n\n::: {#cell-fig-distribution-bx-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-distribution-bx-03\n#| fig-cap: \"Sampling Distribution for b_x=0.3 Estimate\"\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  ggplot(aes(x = estimate, color = method, linetype = method)) +\n  geom_density(alpha = 0.5) +\n  geom_vline(xintercept = 0.3, linetype = \"dotted\") +\n  scale_x_continuous(limits = c(-0.2, 0.8), breaks = c(0, 0.3, 0.6)) +\n  labs(y = \"Density\",\n       x = \"Estimate\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 742295 rows containing non-finite outside the scale range\n(`stat_density()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Sampling Distribution for b_x=0.3 Estimate](mak_figures_files/figure-html/fig-distribution-bx-03-1.png){#fig-distribution-bx-03 width=672}\n:::\n:::\n\n::: {#cell-fig-distribution-bx-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-distribution-bx-05\n#| fig-cap: \"Sampling Distribution for b_x=0.5 Estimate\"\n\nd_05 |> \n  filter(method != \"p_hacked\") |> \n  ggplot(aes(x = estimate, color = method, linetype = method)) +\n  geom_density(alpha = 0.5) +\n  geom_vline(xintercept = 0.5, linetype = \"dotted\") +\n  scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.5, 1)) +\n  labs(y = \"Density\",\n       x = \"Estimate\") + \n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 660359 rows containing non-finite outside the scale range\n(`stat_density()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Sampling Distribution for b_x=0.5 Estimate](mak_figures_files/figure-html/fig-distribution-bx-05-1.png){#fig-distribution-bx-05 width=672}\n:::\n:::\n",
    "supporting": [
      "mak_figures_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}