{
  "hash": "aafc6d9b77a0e3636b1f0e9878aaa2e5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Make Figures for Main Manuscript\"\nauthor: \"Lauren Khoury\"\ndate: \"2025-08-27\"\nnumber-sections: true\noutput: \n  html_document:\n    toc: true \n    toc_depth: 4\nformat:\n  html:\n    embed-resources: true\n    toc: true\n    toc-depth: 4\neditor_options: \n  chunk_output_type: console\nexecute:\n  echo: false\nhtml-table-processing: none\n---\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(dplyr) |> suppressMessages()\nlibrary(skimr)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'skimr' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(purrr)\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'ggplot2' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(cowplot)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'cowplot' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(forcats)\nlibrary(kableExtra, exclude = (\"group_rows\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'kableExtra' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\ntheme_set(theme_classic())\nmethod_colors <- c(\"no_covs\" = \"sienna\",\n                   \"all_covs\" = \"goldenrod2\",\n                   \"p_hacked\" = \"red2\",\n                   \"r\" = \"springgreen3\",\n                   \"partial_r\" = \"deepskyblue\",\n                   \"full_lm\" = \"mediumpurple1\",\n                   \"full_lm_wo_x\" = \"slateblue1\",\n                   \"lasso\" = \"hotpink\",\n                   \"lasso_wo_x\" = \"lightpink\")\nmethod_linetypes <- c(\"no_covs\" = \"solid\",\n                      \"all_covs\" = \"solid\",\n                      \"p_hacked\" = \"longdash\",\n                      \"r\" = \"longdash\",\n                      \"partial_r\" = \"longdash\",\n                      \"full_lm\" = \"longdash\",\n                      \"full_lm_wo_x\" = \"longdash\",\n                      \"lasso\" = \"longdash\",\n                      \"lasso_wo_x\" = \"longdash\")\n\ndevtools::source_url(\"https://github.com/jjcurtin/lab_support/blob/main/format_path.R?raw=true\") |> suppressMessages()\n\n# rdrive_path <- format_path(\"studydata/cov/raw_data\")\nrdrive_path <- \"\\\\\\\\research.drive.wisc.edu\\\\jjcurtin\\\\studydata\\\\cov\\\\raw_data\"\nsetwd(rdrive_path)\n\noptions(digits = 3)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: read in data\n\nd_0 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_method_0.csv\"))\nd_03 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_method_03.csv\"))\nd_05 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_method_05.csv\"))\n\nd_20_covs <- data.table::fread(here::here(rdrive_path, \"batch_results_20_covs.csv\"))\nd_n50 <- data.table::fread(here::here(rdrive_path, \"batch_results_n50.csv\"))\n\nd2_0 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_20K_0.csv\"))\nd2_03 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_20K_03.csv\"))\nd2_05 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_20K_05.csv\"))\n\nd_wo_x_og <- data.table::fread(here::here(rdrive_path, \"batch_results_methods_wo_x_og_seed.csv\"))\nd_wo_x_new <- data.table::fread(here::here(rdrive_path, \"batch_results_methods_wo_x_new_seed.csv\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: combine data\n\nd_0 <- rbind(d_0, d_20_covs |> filter(b_x == 0))\nd_03 <- rbind(d_03, d_20_covs |> filter(b_x == 0.3))\nd_05 <- rbind(d_05, d_20_covs |> filter(b_x == 0.5))\n\nd_0 <- rbind(d_0, d_n50 |> filter(b_x == 0))\nd_03 <- rbind(d_03, d_n50 |> filter(b_x == 0.3))\nd_05 <- rbind(d_05, d_n50 |> filter(b_x == 0.5))\n\nd_0 <- rbind(d_0, d2_0)\nd_03 <- rbind(d_03, d2_03)\nd_05 <- rbind(d_05, d2_05)\n\nd_0 <- rbind(d_0, d_wo_x_og |> filter(b_x == 0))\nd_0 <- rbind(d_0, d_wo_x_new |> filter(b_x == 0))\nd_03 <- rbind(d_03, d_wo_x_og |> filter(b_x == 0.3))\nd_03 <- rbind(d_03, d_wo_x_new |> filter(b_x == 0.3))\nd_05 <- rbind(d_05, d_wo_x_og |> filter(b_x == 0.5))\nd_05 <- rbind(d_05, d_wo_x_new |> filter(b_x == 0.5))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: factor levels\n\nd_0 <- d_0 |> \n  mutate(method = factor(method, c(\"no_covs\", \"all_covs\", \"p_hacked\", \"r\", \"partial_r\", \n                                   \"full_lm\", \"full_lm_wo_x\", \"lasso\", \"lasso_wo_x\")))\n\nd_03 <- d_03 |> \n  mutate(method = factor(method, c(\"no_covs\", \"all_covs\", \"p_hacked\", \"r\", \"partial_r\", \n                                   \"full_lm\", \"full_lm_wo_x\", \"lasso\", \"lasso_wo_x\")))\n\nd_05 <- d_05 |> \n  mutate(method = factor(method, c(\"no_covs\", \"all_covs\", \"p_hacked\", \"r\", \"partial_r\", \n                                   \"full_lm\", \"full_lm_wo_x\", \"lasso\", \"lasso_wo_x\")))\n```\n:::\n\n::: {#cell-fig-typeI-bar .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeI-bar\n#| fig-cap: \"Type I Error by Method\"\n\ntype_I_summary <- d_0 |>\n  group_by(method) |>\n  summarise(type_I = mean(p_value < 0.05))\n\ntype_I_summary |> \n  mutate(method = fct_relevel(method, \"p_hacked\")) |>\n  ggplot(aes(x = method, y = type_I, fill = method)) +\n  geom_bar(stat = \"identity\") +\n  geom_hline(yintercept = 0.05, linetype = \"dotted\", color = \"black\") +\n  geom_text(aes(label = sprintf(\"%.3f\", type_I)), vjust = -0.5) +\n  labs(x = \"Method\",\n       y = \"Type I Error\",\n       fill = \"Method\") +\n  scale_y_continuous(limits = c(0, max(type_I_summary$type_I) * 1.2), \n                     breaks = seq(0, max(type_I_summary$type_I) * 1.2, by = 0.05)) +\n  theme_minimal() +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_fill_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type I Error by Method](mak_figures_files/figure-html/fig-typeI-bar-1.png){#fig-typeI-bar width=672}\n:::\n:::\n\n::: {#cell-fig-typeI-nobs .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeI-nobs\n#| fig-cap: \"Type I Error by Number of Observations\"\n\nd_0 |> \n  group_by(method, n_obs) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_obs, y = prop_sig, color = method, linetype = method)) + \n  geom_line() +\n  geom_hline(yintercept = 0.05, linetype = \"dotted\", color = \"black\") +\n  scale_x_continuous(breaks = c(50, 100, 150, 200, 300, 400)) +\n  scale_y_continuous(breaks = c(0.05, 0.10, 0.15, 0.20)) +\n  labs(x = \"Number of Observations\",\n       y = \"Type I Error\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type I Error by Number of Observations](mak_figures_files/figure-html/fig-typeI-nobs-1.png){#fig-typeI-nobs width=672}\n:::\n:::\n\n::: {#cell-fig-typeI-ncovs .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeI-ncovs\n#| fig-cap: \"Type I Error by Number of Covariates\"\n\nd_0 |> \n  group_by(method, n_covs) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_covs, y = prop_sig, color = method, linetype = method)) + \n  geom_line() +\n  geom_hline(yintercept = 0.05, linetype = \"dotted\", color = \"black\") +\n  scale_x_continuous(breaks = c(4, 8, 12, 16, 20)) +\n  scale_y_continuous(breaks = c(0.05, 0.10, 0.15, 0.20, 0.25)) +\n  labs(y = \"Type I Error\",\n       x = \"Number of Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type I Error by Number of Covariates](mak_figures_files/figure-html/fig-typeI-ncovs-1.png){#fig-typeI-ncovs width=672}\n:::\n:::\n\n::: {#cell-fig-typeI-pgoodcovs .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeI-pgoodcovs\n#| fig-cap: \"Type I Error by Proportion of Good Covariates\"\n\nd_0 |> \n  group_by(method, p_good_covs) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = p_good_covs, y = prop_sig, color = method, linetype = method)) + \n  geom_line() +\n  geom_hline(yintercept = 0.05, linetype = \"dotted\", color = \"black\") +\n  scale_x_continuous(breaks = c(0.25, 0.50, 0.75)) +\n  scale_y_continuous(breaks = c(0.05, 0.10, 0.15, 0.20)) +\n  labs(y = \"Type I Error\",\n       x = \"Proportion of Good Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type I Error by Proportion of Good Covariates](mak_figures_files/figure-html/fig-typeI-pgoodcovs-1.png){#fig-typeI-pgoodcovs width=672}\n:::\n:::\n\n::: {#cell-fig-typeI-rycov .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeI-rycov\n#| fig-cap: \"Type I Error by Y-Covariate Correlation\"\n\nd_0 |> \n  group_by(method, r_ycov) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = r_ycov, y = prop_sig, color = method, linetype = method)) + \n  geom_line() +\n  geom_hline(yintercept = 0.05, linetype = \"dotted\", color = \"black\") +\n  scale_x_continuous(breaks = c(0.3, 0.5)) +\n  scale_y_continuous(breaks = c(0.05, 0.10, 0.15, 0.20, 0.25, 0.30)) +\n  labs(y = \"Type I Error\",\n       x = \"Y-Covariate Correlation\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type I Error by Y-Covariate Correlation](mak_figures_files/figure-html/fig-typeI-rycov-1.png){#fig-typeI-rycov width=672}\n:::\n:::\n\n::: {#cell-fig-distribution-bx-0 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-distribution-bx-0\n#| fig-cap: \"Sampling Distribution for b_x=0 Estimate\"\n\nd_0 |> \n  ggplot(aes(x = estimate, color = method, linetype = method)) +\n  geom_density(alpha = 0.5) +\n  geom_vline(xintercept = 0, linetype = \"dotted\", color = \"black\") +\n  scale_x_continuous(limits = c(-0.5, 0.5), breaks = seq(-0.5, 0.5, by = 0.5)) +\n  labs(y = \"Density\",\n       x = \"Estimate\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 798111 rows containing non-finite outside the scale range\n(`stat_density()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Sampling Distribution for b_x=0 Estimate](mak_figures_files/figure-html/fig-distribution-bx-0-1.png){#fig-distribution-bx-0 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-bar-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-bar-03\n#| fig-cap: \"Type II Error by Method, b_x=0.3\"\n\ntype_II_summary_03 <- d_03 |>\n  filter(method != \"p_hacked\") |> \n  group_by(method) |>\n  summarise(type_II = mean(p_value >= 0.05))\n\ntype_II_summary_03 |> \nggplot(aes(x = method, y = type_II, fill = method)) +\n  geom_bar(stat = \"identity\") +\n  geom_text(aes(label = sprintf(\"%.3f\", type_II)), vjust = -0.5) +\n  labs(x = \"Method\",\n       y = \"Type II Error\",\n       fill = \"Method\") +\n  scale_y_continuous(limits = c(0, max(type_II_summary_03$type_II) * 1.2), \n                     breaks = seq(0, max(type_II_summary_03$type_II) * 1.2, by = 0.05)) +\n  theme_minimal() +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_fill_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Method, b_x=0.3](mak_figures_files/figure-html/fig-typeII-bar-03-1.png){#fig-typeII-bar-03 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-bar-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-bar-05\n#| fig-cap: \"Type II Error by Method, b_x=0.5\"\n\ntype_II_summary_05 <- d_05 |>\n  filter(method != \"p_hacked\") |> \n  group_by(method) |>\n  summarise(type_II = mean(p_value >= 0.05))\n\ntype_II_summary_05 |> \nggplot(aes(x = method, y = type_II, fill = method)) +\n  geom_bar(stat = \"identity\") +\n  geom_text(aes(label = sprintf(\"%.3f\", type_II)), vjust = -0.5) +\n  labs(x = \"Method\",\n       y = \"Type II Error\",\n       fill = \"Method\") +\n  scale_y_continuous(limits = c(0, max(type_II_summary_05$type_II) * 1.2), \n                     breaks = seq(0, max(type_II_summary_05$type_II) * 1.2, by = 0.05)) +\n  theme_minimal() +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_fill_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Method, b_x=0.5](mak_figures_files/figure-html/fig-typeII-bar-05-1.png){#fig-typeII-bar-05 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-nobs-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-nobs-03\n#| fig-cap: \"Type II Error by Number of Observations, b_x=0.3\"\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, n_obs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_obs, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(50, 100, 150, 200, 300, 400)) +\n  labs(y = \"Type II Error\",\n       x = \"Number of Observations\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Number of Observations, b_x=0.3](mak_figures_files/figure-html/fig-typeII-nobs-03-1.png){#fig-typeII-nobs-03 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-nobs-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-nobs-05\n#| fig-cap: \"Type II Error by Number of Observations, b_x=0.5\"\n\nd_05 |> \n  filter(method != \"p_hacked\") |>\n  group_by(method, n_obs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_obs, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(50, 100, 150, 200, 300, 400)) +\n  labs(y = \"Type II Error\",\n       x = \"Number of Observations\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Number of Observations, b_x=0.5](mak_figures_files/figure-html/fig-typeII-nobs-05-1.png){#fig-typeII-nobs-05 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-ncovs-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-ncovs-03\n#| fig-cap: \"Type II Error by Number of Covariates, b_x=0.3\"\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, n_covs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_covs, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(4, 8, 12, 16, 20)) +\n  labs(y = \"Type II Error\",\n       x = \"Number of Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Number of Covariates, b_x=0.3](mak_figures_files/figure-html/fig-typeII-ncovs-03-1.png){#fig-typeII-ncovs-03 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-ncovs-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-ncovs-05\n#| fig-cap: \"Type II Error by Number of Covariates, b_x=0.5\"\n\nd_05 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, n_covs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_covs, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(4, 8, 12, 16, 20)) +\n  labs(y = \"Type II Error\",\n       x = \"Number of Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Number of Covariates, b_x=0.5](mak_figures_files/figure-html/fig-typeII-ncovs-05-1.png){#fig-typeII-ncovs-05 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-pgoodcovs-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-pgoodcovs-03\n#| fig-cap: \"Type II Error by Proportion of Good Covariates, b_x=0.3\"\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, p_good_covs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = p_good_covs, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(0.25, 0.50, 0.75)) +\n  labs(y = \"Type II Error\",\n       x = \"Proportion of Good Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Proportion of Good Covariates, b_x=0.3](mak_figures_files/figure-html/fig-typeII-pgoodcovs-03-1.png){#fig-typeII-pgoodcovs-03 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-pgoodcovs-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-pgoodcovs-05\n#| fig-cap: \"Type II Error by Proportion of Good Covariates, b_x=0.5\"\n\nd_05 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, p_good_covs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = p_good_covs, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(0.25, 0.50, 0.75)) +\n  labs(y = \"Type II Error\",\n       x = \"Proportion of Good Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Proportion of Good Covariates, b_x=0.5](mak_figures_files/figure-html/fig-typeII-pgoodcovs-05-1.png){#fig-typeII-pgoodcovs-05 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-rycov-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-rycov-03\n#| fig-cap: \"Type II Error by Y-Covariate Correlation, b_x=0.3\"\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, r_ycov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = r_ycov, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(0.3, 0.5)) +\n  labs(y = \"Type II Error\",\n       x = \"Y-Covariate Correlation\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Y-Covariate Correlation, b_x=0.3](mak_figures_files/figure-html/fig-typeII-rycov-03-1.png){#fig-typeII-rycov-03 width=672}\n:::\n:::\n\n::: {#cell-fig-typeII-rycov-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-typeII-rycov-05\n#| fig-cap: \"Type II Error by Y-Covariate Correlation, b_x=0.5\"\n\nd_05 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, r_ycov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = r_ycov, y = prop_not_sig, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(0.3, 0.5)) +\n  labs(y = \"Type II Error\",\n       x = \"Y-Covariate Correlation\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![Type II Error by Y-Covariate Correlation, b_x=0.5](mak_figures_files/figure-html/fig-typeII-rycov-05-1.png){#fig-typeII-rycov-05 width=672}\n:::\n:::\n\n::: {#cell-fig-distribution-bx-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-distribution-bx-03\n#| fig-cap: \"Sampling Distribution for b_x=0.3 Estimate\"\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  ggplot(aes(x = estimate, color = method, linetype = method)) +\n  geom_density(alpha = 0.5) +\n  geom_vline(xintercept = 0.3, linetype = \"dotted\") +\n  scale_x_continuous(limits = c(-0.2, 0.8), breaks = c(0, 0.3, 0.6)) +\n  labs(y = \"Density\",\n       x = \"Estimate\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 522893 rows containing non-finite outside the scale range\n(`stat_density()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Sampling Distribution for b_x=0.3 Estimate](mak_figures_files/figure-html/fig-distribution-bx-03-1.png){#fig-distribution-bx-03 width=672}\n:::\n:::\n\n::: {#cell-fig-distribution-bx-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-distribution-bx-05\n#| fig-cap: \"Sampling Distribution for b_x=0.5 Estimate\"\n\nd_05 |> \n  filter(method != \"p_hacked\") |> \n  ggplot(aes(x = estimate, color = method, linetype = method)) +\n  geom_density(alpha = 0.5) +\n  geom_vline(xintercept = 0.5, linetype = \"dotted\") +\n  scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.5, 1)) +\n  labs(y = \"Density\",\n       x = \"Estimate\") + \n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 529644 rows containing non-finite outside the scale range\n(`stat_density()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Sampling Distribution for b_x=0.5 Estimate](mak_figures_files/figure-html/fig-distribution-bx-05-1.png){#fig-distribution-bx-05 width=672}\n:::\n:::\n",
    "supporting": [
      "mak_figures_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}