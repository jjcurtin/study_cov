{
  "hash": "08c6d2f80194dee736233a149b10f94e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Supplemental Material\"\ndate: last-modified\nnumber-sections: true\nformat: \n  html: \n    embed-resources: true\n    toc: true \n    toc_depth: 5\nexecute:\n  echo: false\neditor_options: \n  chunk_output_type: console\n---\n\n\n\nThis file contains the supplemental materials for *Title of paper*. It includes all supplemental figures and tables. Additional materials are made available on our study's OSF page ([https://osf.io/zh5gn/](https://osf.io/zh5gn/)).   \n\n-----\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(dplyr) |> suppressMessages()\nlibrary(skimr)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'skimr' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(purrr)\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'ggplot2' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(cowplot)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'cowplot' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(forcats)\nlibrary(kableExtra, exclude = (\"group_rows\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'kableExtra' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\ntheme_set(theme_classic())\nmethod_colors <- c(\"no_covs\" = \"sienna\",\n                   \"all_covs\" = \"goldenrod2\",\n                   \"p_hacked\" = \"red2\",\n                   \"r\" = \"springgreen3\",\n                   \"partial_r\" = \"deepskyblue\",\n                   \"full_lm\" = \"mediumpurple1\",\n                   \"full_lm_wo_x\" = \"slateblue1\",\n                   \"lasso\" = \"hotpink\",\n                   \"lasso_wo_x\" = \"lightpink\")\nmethod_linetypes <- c(\"no_covs\" = \"solid\",\n                      \"all_covs\" = \"solid\",\n                      \"p_hacked\" = \"longdash\",\n                      \"r\" = \"longdash\",\n                      \"partial_r\" = \"longdash\",\n                      \"full_lm\" = \"longdash\",\n                      \"full_lm_wo_x\" = \"longdash\",\n                      \"lasso\" = \"longdash\",\n                      \"lasso_wo_x\" = \"longdash\")\n\ndevtools::source_url(\"https://github.com/jjcurtin/lab_support/blob/main/format_path.R?raw=true\") |> suppressMessages()\n\n# rdrive_path <- format_path(\"studydata/cov/raw_data\")\nrdrive_path <- \"\\\\\\\\research.drive.wisc.edu\\\\jjcurtin\\\\studydata\\\\cov\\\\raw_data\"\nsetwd(rdrive_path)\n\noptions(digits = 3)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: read in data\n\nd_0 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_method_0.csv\"))\nd_03 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_method_03.csv\"))\nd_05 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_method_05.csv\"))\n\nd_20_covs <- data.table::fread(here::here(rdrive_path, \"batch_results_20_covs.csv\"))\nd_n50 <- data.table::fread(here::here(rdrive_path, \"batch_results_n50.csv\"))\n\nd2_0 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_20K_0.csv\"))\nd2_03 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_20K_03.csv\"))\nd2_05 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_20K_05.csv\"))\n\nd_wo_x_og <- data.table::fread(here::here(rdrive_path, \"batch_results_methods_wo_x_og_seed.csv\"))\nd_wo_x_new <- data.table::fread(here::here(rdrive_path, \"batch_results_methods_wo_x_new_seed.csv\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: combine data\n\nd_0 <- rbind(d_0, d_20_covs |> filter(b_x == 0))\nd_03 <- rbind(d_03, d_20_covs |> filter(b_x == 0.3))\nd_05 <- rbind(d_05, d_20_covs |> filter(b_x == 0.5))\n\nd_0 <- rbind(d_0, d_n50 |> filter(b_x == 0))\nd_03 <- rbind(d_03, d_n50 |> filter(b_x == 0.3))\nd_05 <- rbind(d_05, d_n50 |> filter(b_x == 0.5))\n\nd_0 <- rbind(d_0, d2_0)\nd_03 <- rbind(d_03, d2_03)\nd_05 <- rbind(d_05, d2_05)\n\nd_0 <- rbind(d_0, d_wo_x_og |> filter(b_x == 0))\nd_0 <- rbind(d_0, d_wo_x_new |> filter(b_x == 0))\nd_03 <- rbind(d_03, d_wo_x_og |> filter(b_x == 0.3))\nd_03 <- rbind(d_03, d_wo_x_new |> filter(b_x == 0.3))\nd_05 <- rbind(d_05, d_wo_x_og |> filter(b_x == 0.5))\nd_05 <- rbind(d_05, d_wo_x_new |> filter(b_x == 0.5))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: factor levels\n\nd_0 <- d_0 |> \n  mutate(method = factor(method, c(\"no_covs\", \"all_covs\", \"p_hacked\", \"r\", \"partial_r\", \n                                   \"full_lm\", \"full_lm_wo_x\", \"lasso\", \"lasso_wo_x\")))\n\nd_03 <- d_03 |> \n  mutate(method = factor(method, c(\"no_covs\", \"all_covs\", \"p_hacked\", \"r\", \"partial_r\", \n                                   \"full_lm\", \"full_lm_wo_x\", \"lasso\", \"lasso_wo_x\")))\n\nd_05 <- d_05 |> \n  mutate(method = factor(method, c(\"no_covs\", \"all_covs\", \"p_hacked\", \"r\", \"partial_r\", \n                                   \"full_lm\", \"full_lm_wo_x\", \"lasso\", \"lasso_wo_x\")))\n```\n:::\n\n\n\n### Type I error\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: histogram variable 0\n\nh0 <- d_0 |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(type_I = mean(p_value < 0.05),\n            .groups = \"drop\")\n```\n:::\n\n::: {#cell-fig-histogram-phack .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-histogram-phack\n\nh0 |>\n  filter(method == \"p_hacked\") |> \n  ggplot(aes(x = type_I)) +\n  geom_histogram() +\n  facet_wrap(~ method) +\n  labs(x = \"Type I Error\",\n       title = \"Distribution of Type I error: p-hacked\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-histogram-phack-1.png){#fig-histogram-phack width=672}\n:::\n:::\n\n::: {#cell-fig-histograms-all-0 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-histograms-all-0\n\nh0 |>\n  filter(method != \"p_hacked\") |> \n  ggplot(aes(x = type_I)) +\n  geom_histogram() +\n  facet_wrap(~ method) +\n  labs(x = \"Type I Error\",\n       title = \"Distribution of Type I error\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-histograms-all-0-1.png){#fig-histograms-all-0 width=672}\n:::\n:::\n\n::: {#tbl-typeI-nobs .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeI-nobs \n\nd_0 |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  group_by(n_obs, method) |> \n  summarise(typeI_min = min(prop_sig),\n            typeI_max = max(prop_sig),\n            typeI_mean = mean(prop_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type I error by n_obs\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type I error by n_obs</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> n_obs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeI_min </th>\n   <th style=\"text-align:right;\"> typeI_max </th>\n   <th style=\"text-align:right;\"> typeI_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.084 </td>\n   <td style=\"text-align:right;\"> 0.426 </td>\n   <td style=\"text-align:right;\"> 0.215 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.072 </td>\n   <td style=\"text-align:right;\"> 0.057 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.096 </td>\n   <td style=\"text-align:right;\"> 0.074 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.089 </td>\n   <td style=\"text-align:right;\"> 0.069 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.078 </td>\n   <td style=\"text-align:right;\"> 0.449 </td>\n   <td style=\"text-align:right;\"> 0.203 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.059 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n   <td style=\"text-align:right;\"> 0.087 </td>\n   <td style=\"text-align:right;\"> 0.064 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n   <td style=\"text-align:right;\"> 0.067 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.076 </td>\n   <td style=\"text-align:right;\"> 0.454 </td>\n   <td style=\"text-align:right;\"> 0.198 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.081 </td>\n   <td style=\"text-align:right;\"> 0.059 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n   <td style=\"text-align:right;\"> 0.055 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.074 </td>\n   <td style=\"text-align:right;\"> 0.456 </td>\n   <td style=\"text-align:right;\"> 0.194 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.059 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.073 </td>\n   <td style=\"text-align:right;\"> 0.455 </td>\n   <td style=\"text-align:right;\"> 0.189 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.061 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n   <td style=\"text-align:right;\"> 0.462 </td>\n   <td style=\"text-align:right;\"> 0.186 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.055 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeI-ncovs .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeI-ncovs\n\nd_0 |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  group_by(n_covs, method) |> \n  summarise(typeI_min = min(prop_sig),\n            typeI_max = max(prop_sig),\n            typeI_mean = mean(prop_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type I error by n_covs\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type I error by n_covs</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> n_covs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeI_min </th>\n   <th style=\"text-align:right;\"> typeI_max </th>\n   <th style=\"text-align:right;\"> typeI_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n   <td style=\"text-align:right;\"> 0.140 </td>\n   <td style=\"text-align:right;\"> 0.098 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.094 </td>\n   <td style=\"text-align:right;\"> 0.238 </td>\n   <td style=\"text-align:right;\"> 0.150 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.082 </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.067 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.117 </td>\n   <td style=\"text-align:right;\"> 0.329 </td>\n   <td style=\"text-align:right;\"> 0.201 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.064 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.093 </td>\n   <td style=\"text-align:right;\"> 0.060 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.074 </td>\n   <td style=\"text-align:right;\"> 0.057 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.139 </td>\n   <td style=\"text-align:right;\"> 0.404 </td>\n   <td style=\"text-align:right;\"> 0.249 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.069 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n   <td style=\"text-align:right;\"> 0.094 </td>\n   <td style=\"text-align:right;\"> 0.064 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n   <td style=\"text-align:right;\"> 0.080 </td>\n   <td style=\"text-align:right;\"> 0.059 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.165 </td>\n   <td style=\"text-align:right;\"> 0.462 </td>\n   <td style=\"text-align:right;\"> 0.290 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.072 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.096 </td>\n   <td style=\"text-align:right;\"> 0.066 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.089 </td>\n   <td style=\"text-align:right;\"> 0.061 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeI-pgoodcovs .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeI-pgoodcovs\n\nd_0 |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  group_by(p_good_covs, method) |> \n  summarise(typeI_min = min(prop_sig),\n            typeI_max = max(prop_sig),\n            typeI_mean = mean(prop_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type I error by p_good_covs\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type I error by p_good_covs</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> p_good_covs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeI_min </th>\n   <th style=\"text-align:right;\"> typeI_max </th>\n   <th style=\"text-align:right;\"> typeI_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n   <td style=\"text-align:right;\"> 0.344 </td>\n   <td style=\"text-align:right;\"> 0.163 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.072 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.090 </td>\n   <td style=\"text-align:right;\"> 0.057 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.089 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.084 </td>\n   <td style=\"text-align:right;\"> 0.400 </td>\n   <td style=\"text-align:right;\"> 0.202 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.063 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.094 </td>\n   <td style=\"text-align:right;\"> 0.060 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.084 </td>\n   <td style=\"text-align:right;\"> 0.057 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.093 </td>\n   <td style=\"text-align:right;\"> 0.462 </td>\n   <td style=\"text-align:right;\"> 0.227 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.059 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.096 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.081 </td>\n   <td style=\"text-align:right;\"> 0.055 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeI-rycov .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeI-rycov\n\nd_0 |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  group_by(r_ycov, method) |> \n  summarise(typeI_min = min(prop_sig),\n            typeI_max = max(prop_sig),\n            typeI_mean = mean(prop_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type I error by y-cov correlations\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type I error by y-cov correlations</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r_ycov </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeI_min </th>\n   <th style=\"text-align:right;\"> typeI_max </th>\n   <th style=\"text-align:right;\"> typeI_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n   <td style=\"text-align:right;\"> 0.276 </td>\n   <td style=\"text-align:right;\"> 0.145 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.072 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.075 </td>\n   <td style=\"text-align:right;\"> 0.059 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.085 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:right;\"> 0.082 </td>\n   <td style=\"text-align:right;\"> 0.462 </td>\n   <td style=\"text-align:right;\"> 0.250 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.096 </td>\n   <td style=\"text-align:right;\"> 0.060 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.089 </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### Type II error\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: histograms variable 03\n\nh03 <- d_03 |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(type_II = mean(p_value >= 0.05),\n            .groups = \"drop\")\n```\n:::\n\n::: {#cell-fig-histograms-all-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-histograms-all-03\n\nh03 |>\n  filter(method != \"p_hacked\") |> \n  ggplot(aes(x = type_II)) +\n  geom_histogram() +\n  facet_wrap(~ method) +\n  labs(x = \"Type II Error\",\n       title = \"Distribution of Type II error, b_x = 0.3\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-histograms-all-03-1.png){#fig-histograms-all-03 width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: histograms variable 05\n\nh05 <- d_05 |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(type_II = mean(p_value >= 0.05),\n            .groups = \"drop\")\n```\n:::\n\n::: {#cell-fig-histograms-all-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-histograms-all-05\n\nh05 |>\n  filter(method != \"p_hacked\") |> \n  ggplot(aes(x = type_II)) +\n  geom_histogram() +\n  facet_wrap(~ method) +\n  labs(x = \"Type II Error\",\n       title = \"Distribution of Type II error, b_x = 0.5\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-histograms-all-05-1.png){#fig-histograms-all-05 width=672}\n:::\n:::\n\n::: {#tbl-typeII-nobs-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-nobs-03\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(n_obs, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by n_obs, b_x = 0.3\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by n_obs, b_x = 0.3</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> n_obs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.815 </td>\n   <td style=\"text-align:right;\"> 0.824 </td>\n   <td style=\"text-align:right;\"> 0.819 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.662 </td>\n   <td style=\"text-align:right;\"> 0.860 </td>\n   <td style=\"text-align:right;\"> 0.778 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.628 </td>\n   <td style=\"text-align:right;\"> 0.816 </td>\n   <td style=\"text-align:right;\"> 0.750 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.623 </td>\n   <td style=\"text-align:right;\"> 0.801 </td>\n   <td style=\"text-align:right;\"> 0.731 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.644 </td>\n   <td style=\"text-align:right;\"> 0.801 </td>\n   <td style=\"text-align:right;\"> 0.735 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.742 </td>\n   <td style=\"text-align:right;\"> 0.831 </td>\n   <td style=\"text-align:right;\"> 0.798 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.557 </td>\n   <td style=\"text-align:right;\"> 0.800 </td>\n   <td style=\"text-align:right;\"> 0.713 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.629 </td>\n   <td style=\"text-align:right;\"> 0.824 </td>\n   <td style=\"text-align:right;\"> 0.761 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.676 </td>\n   <td style=\"text-align:right;\"> 0.685 </td>\n   <td style=\"text-align:right;\"> 0.681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.296 </td>\n   <td style=\"text-align:right;\"> 0.684 </td>\n   <td style=\"text-align:right;\"> 0.549 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.269 </td>\n   <td style=\"text-align:right;\"> 0.665 </td>\n   <td style=\"text-align:right;\"> 0.528 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.266 </td>\n   <td style=\"text-align:right;\"> 0.657 </td>\n   <td style=\"text-align:right;\"> 0.520 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.337 </td>\n   <td style=\"text-align:right;\"> 0.656 </td>\n   <td style=\"text-align:right;\"> 0.528 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.427 </td>\n   <td style=\"text-align:right;\"> 0.676 </td>\n   <td style=\"text-align:right;\"> 0.577 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.256 </td>\n   <td style=\"text-align:right;\"> 0.656 </td>\n   <td style=\"text-align:right;\"> 0.513 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.280 </td>\n   <td style=\"text-align:right;\"> 0.670 </td>\n   <td style=\"text-align:right;\"> 0.540 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.549 </td>\n   <td style=\"text-align:right;\"> 0.560 </td>\n   <td style=\"text-align:right;\"> 0.554 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.107 </td>\n   <td style=\"text-align:right;\"> 0.529 </td>\n   <td style=\"text-align:right;\"> 0.378 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.098 </td>\n   <td style=\"text-align:right;\"> 0.525 </td>\n   <td style=\"text-align:right;\"> 0.364 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.097 </td>\n   <td style=\"text-align:right;\"> 0.521 </td>\n   <td style=\"text-align:right;\"> 0.360 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.141 </td>\n   <td style=\"text-align:right;\"> 0.521 </td>\n   <td style=\"text-align:right;\"> 0.366 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.187 </td>\n   <td style=\"text-align:right;\"> 0.535 </td>\n   <td style=\"text-align:right;\"> 0.393 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.097 </td>\n   <td style=\"text-align:right;\"> 0.520 </td>\n   <td style=\"text-align:right;\"> 0.356 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.098 </td>\n   <td style=\"text-align:right;\"> 0.531 </td>\n   <td style=\"text-align:right;\"> 0.371 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.436 </td>\n   <td style=\"text-align:right;\"> 0.443 </td>\n   <td style=\"text-align:right;\"> 0.440 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.032 </td>\n   <td style=\"text-align:right;\"> 0.406 </td>\n   <td style=\"text-align:right;\"> 0.257 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.029 </td>\n   <td style=\"text-align:right;\"> 0.402 </td>\n   <td style=\"text-align:right;\"> 0.248 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.029 </td>\n   <td style=\"text-align:right;\"> 0.400 </td>\n   <td style=\"text-align:right;\"> 0.245 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> 0.399 </td>\n   <td style=\"text-align:right;\"> 0.250 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.066 </td>\n   <td style=\"text-align:right;\"> 0.406 </td>\n   <td style=\"text-align:right;\"> 0.266 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.030 </td>\n   <td style=\"text-align:right;\"> 0.399 </td>\n   <td style=\"text-align:right;\"> 0.244 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.034 </td>\n   <td style=\"text-align:right;\"> 0.408 </td>\n   <td style=\"text-align:right;\"> 0.253 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.260 </td>\n   <td style=\"text-align:right;\"> 0.268 </td>\n   <td style=\"text-align:right;\"> 0.264 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 0.230 </td>\n   <td style=\"text-align:right;\"> 0.118 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 0.229 </td>\n   <td style=\"text-align:right;\"> 0.114 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 0.227 </td>\n   <td style=\"text-align:right;\"> 0.113 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.004 </td>\n   <td style=\"text-align:right;\"> 0.227 </td>\n   <td style=\"text-align:right;\"> 0.116 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.225 </td>\n   <td style=\"text-align:right;\"> 0.123 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 0.227 </td>\n   <td style=\"text-align:right;\"> 0.113 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 0.228 </td>\n   <td style=\"text-align:right;\"> 0.116 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.148 </td>\n   <td style=\"text-align:right;\"> 0.155 </td>\n   <td style=\"text-align:right;\"> 0.151 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.121 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.119 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.119 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.119 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.121 </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.119 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.122 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeII-nobs-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-nobs-05\n\nd_05 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(n_obs, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by n_obs, b_x = 0.5\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by n_obs, b_x = 0.5</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> n_obs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.585 </td>\n   <td style=\"text-align:right;\"> 0.595 </td>\n   <td style=\"text-align:right;\"> 0.589 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.274 </td>\n   <td style=\"text-align:right;\"> 0.687 </td>\n   <td style=\"text-align:right;\"> 0.503 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.227 </td>\n   <td style=\"text-align:right;\"> 0.581 </td>\n   <td style=\"text-align:right;\"> 0.446 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.223 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.420 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.318 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.454 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.423 </td>\n   <td style=\"text-align:right;\"> 0.608 </td>\n   <td style=\"text-align:right;\"> 0.542 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.171 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.408 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.229 </td>\n   <td style=\"text-align:right;\"> 0.598 </td>\n   <td style=\"text-align:right;\"> 0.467 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.296 </td>\n   <td style=\"text-align:right;\"> 0.308 </td>\n   <td style=\"text-align:right;\"> 0.303 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.014 </td>\n   <td style=\"text-align:right;\"> 0.304 </td>\n   <td style=\"text-align:right;\"> 0.171 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.276 </td>\n   <td style=\"text-align:right;\"> 0.151 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.268 </td>\n   <td style=\"text-align:right;\"> 0.146 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.035 </td>\n   <td style=\"text-align:right;\"> 0.268 </td>\n   <td style=\"text-align:right;\"> 0.158 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n   <td style=\"text-align:right;\"> 0.295 </td>\n   <td style=\"text-align:right;\"> 0.189 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.009 </td>\n   <td style=\"text-align:right;\"> 0.270 </td>\n   <td style=\"text-align:right;\"> 0.144 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.012 </td>\n   <td style=\"text-align:right;\"> 0.285 </td>\n   <td style=\"text-align:right;\"> 0.159 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.136 </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n   <td style=\"text-align:right;\"> 0.140 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.119 </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.115 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.113 </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n   <td style=\"text-align:right;\"> 0.113 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 0.121 </td>\n   <td style=\"text-align:right;\"> 0.063 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.114 </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.114 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n   <td style=\"text-align:right;\"> 0.059 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.044 </td>\n   <td style=\"text-align:right;\"> 0.018 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> 0.016 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.042 </td>\n   <td style=\"text-align:right;\"> 0.016 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.042 </td>\n   <td style=\"text-align:right;\"> 0.018 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.044 </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> 0.016 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.044 </td>\n   <td style=\"text-align:right;\"> 0.017 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.008 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.009 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeII-ncovs-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-ncovs-03\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(n_covs, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by n_covs, b_x = 0.3\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by n_covs, b_x = 0.3</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> n_covs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.148 </td>\n   <td style=\"text-align:right;\"> 0.821 </td>\n   <td style=\"text-align:right;\"> 0.485 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.015 </td>\n   <td style=\"text-align:right;\"> 0.820 </td>\n   <td style=\"text-align:right;\"> 0.396 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.015 </td>\n   <td style=\"text-align:right;\"> 0.816 </td>\n   <td style=\"text-align:right;\"> 0.393 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.015 </td>\n   <td style=\"text-align:right;\"> 0.801 </td>\n   <td style=\"text-align:right;\"> 0.390 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.015 </td>\n   <td style=\"text-align:right;\"> 0.801 </td>\n   <td style=\"text-align:right;\"> 0.389 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.017 </td>\n   <td style=\"text-align:right;\"> 0.819 </td>\n   <td style=\"text-align:right;\"> 0.397 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.015 </td>\n   <td style=\"text-align:right;\"> 0.800 </td>\n   <td style=\"text-align:right;\"> 0.390 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.017 </td>\n   <td style=\"text-align:right;\"> 0.820 </td>\n   <td style=\"text-align:right;\"> 0.396 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.150 </td>\n   <td style=\"text-align:right;\"> 0.822 </td>\n   <td style=\"text-align:right;\"> 0.485 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.004 </td>\n   <td style=\"text-align:right;\"> 0.826 </td>\n   <td style=\"text-align:right;\"> 0.361 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 0.816 </td>\n   <td style=\"text-align:right;\"> 0.354 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 0.791 </td>\n   <td style=\"text-align:right;\"> 0.349 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.004 </td>\n   <td style=\"text-align:right;\"> 0.790 </td>\n   <td style=\"text-align:right;\"> 0.349 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 0.822 </td>\n   <td style=\"text-align:right;\"> 0.368 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.004 </td>\n   <td style=\"text-align:right;\"> 0.788 </td>\n   <td style=\"text-align:right;\"> 0.348 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 0.823 </td>\n   <td style=\"text-align:right;\"> 0.360 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.150 </td>\n   <td style=\"text-align:right;\"> 0.821 </td>\n   <td style=\"text-align:right;\"> 0.485 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.832 </td>\n   <td style=\"text-align:right;\"> 0.345 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.813 </td>\n   <td style=\"text-align:right;\"> 0.332 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.783 </td>\n   <td style=\"text-align:right;\"> 0.326 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.782 </td>\n   <td style=\"text-align:right;\"> 0.330 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.824 </td>\n   <td style=\"text-align:right;\"> 0.359 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.772 </td>\n   <td style=\"text-align:right;\"> 0.322 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.823 </td>\n   <td style=\"text-align:right;\"> 0.340 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.149 </td>\n   <td style=\"text-align:right;\"> 0.823 </td>\n   <td style=\"text-align:right;\"> 0.485 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.843 </td>\n   <td style=\"text-align:right;\"> 0.339 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.812 </td>\n   <td style=\"text-align:right;\"> 0.320 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.783 </td>\n   <td style=\"text-align:right;\"> 0.314 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.779 </td>\n   <td style=\"text-align:right;\"> 0.321 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.826 </td>\n   <td style=\"text-align:right;\"> 0.359 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.760 </td>\n   <td style=\"text-align:right;\"> 0.306 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.823 </td>\n   <td style=\"text-align:right;\"> 0.328 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.149 </td>\n   <td style=\"text-align:right;\"> 0.824 </td>\n   <td style=\"text-align:right;\"> 0.485 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.860 </td>\n   <td style=\"text-align:right;\"> 0.337 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.816 </td>\n   <td style=\"text-align:right;\"> 0.313 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.791 </td>\n   <td style=\"text-align:right;\"> 0.305 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.783 </td>\n   <td style=\"text-align:right;\"> 0.317 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.831 </td>\n   <td style=\"text-align:right;\"> 0.361 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.758 </td>\n   <td style=\"text-align:right;\"> 0.293 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.824 </td>\n   <td style=\"text-align:right;\"> 0.321 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeII-ncovs-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-ncovs-05\n\nd_05 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(n_covs, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by n_covs, b_x = 0.5\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by n_covs, b_x = 0.5</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> n_covs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.595 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.589 </td>\n   <td style=\"text-align:right;\"> 0.134 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.581 </td>\n   <td style=\"text-align:right;\"> 0.132 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.128 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.129 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.587 </td>\n   <td style=\"text-align:right;\"> 0.137 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.129 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.588 </td>\n   <td style=\"text-align:right;\"> 0.134 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.593 </td>\n   <td style=\"text-align:right;\"> 0.183 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.605 </td>\n   <td style=\"text-align:right;\"> 0.121 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.578 </td>\n   <td style=\"text-align:right;\"> 0.114 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.539 </td>\n   <td style=\"text-align:right;\"> 0.109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.546 </td>\n   <td style=\"text-align:right;\"> 0.114 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.591 </td>\n   <td style=\"text-align:right;\"> 0.130 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.540 </td>\n   <td style=\"text-align:right;\"> 0.109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.588 </td>\n   <td style=\"text-align:right;\"> 0.119 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.594 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.624 </td>\n   <td style=\"text-align:right;\"> 0.119 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.569 </td>\n   <td style=\"text-align:right;\"> 0.106 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.520 </td>\n   <td style=\"text-align:right;\"> 0.100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.538 </td>\n   <td style=\"text-align:right;\"> 0.110 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.605 </td>\n   <td style=\"text-align:right;\"> 0.134 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.518 </td>\n   <td style=\"text-align:right;\"> 0.099 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.593 </td>\n   <td style=\"text-align:right;\"> 0.113 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.593 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.656 </td>\n   <td style=\"text-align:right;\"> 0.122 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.576 </td>\n   <td style=\"text-align:right;\"> 0.102 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.525 </td>\n   <td style=\"text-align:right;\"> 0.096 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.538 </td>\n   <td style=\"text-align:right;\"> 0.109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.605 </td>\n   <td style=\"text-align:right;\"> 0.137 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.513 </td>\n   <td style=\"text-align:right;\"> 0.092 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.597 </td>\n   <td style=\"text-align:right;\"> 0.109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.591 </td>\n   <td style=\"text-align:right;\"> 0.183 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.687 </td>\n   <td style=\"text-align:right;\"> 0.128 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.575 </td>\n   <td style=\"text-align:right;\"> 0.100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.536 </td>\n   <td style=\"text-align:right;\"> 0.094 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.541 </td>\n   <td style=\"text-align:right;\"> 0.111 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.608 </td>\n   <td style=\"text-align:right;\"> 0.142 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.087 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.598 </td>\n   <td style=\"text-align:right;\"> 0.107 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeII-pgoodcovs-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-pgoodcovs-03\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(p_good_covs, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by p_good_covs, b_x = 0.3\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by p_good_covs, b_x = 0.3</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> p_good_covs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.148 </td>\n   <td style=\"text-align:right;\"> 0.824 </td>\n   <td style=\"text-align:right;\"> 0.485 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.007 </td>\n   <td style=\"text-align:right;\"> 0.860 </td>\n   <td style=\"text-align:right;\"> 0.392 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n   <td style=\"text-align:right;\"> 0.816 </td>\n   <td style=\"text-align:right;\"> 0.375 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n   <td style=\"text-align:right;\"> 0.801 </td>\n   <td style=\"text-align:right;\"> 0.366 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n   <td style=\"text-align:right;\"> 0.801 </td>\n   <td style=\"text-align:right;\"> 0.367 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.831 </td>\n   <td style=\"text-align:right;\"> 0.386 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n   <td style=\"text-align:right;\"> 0.800 </td>\n   <td style=\"text-align:right;\"> 0.363 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n   <td style=\"text-align:right;\"> 0.824 </td>\n   <td style=\"text-align:right;\"> 0.385 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.149 </td>\n   <td style=\"text-align:right;\"> 0.823 </td>\n   <td style=\"text-align:right;\"> 0.485 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.852 </td>\n   <td style=\"text-align:right;\"> 0.349 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.814 </td>\n   <td style=\"text-align:right;\"> 0.336 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.795 </td>\n   <td style=\"text-align:right;\"> 0.330 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.794 </td>\n   <td style=\"text-align:right;\"> 0.335 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.826 </td>\n   <td style=\"text-align:right;\"> 0.363 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.792 </td>\n   <td style=\"text-align:right;\"> 0.326 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.818 </td>\n   <td style=\"text-align:right;\"> 0.343 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.148 </td>\n   <td style=\"text-align:right;\"> 0.821 </td>\n   <td style=\"text-align:right;\"> 0.485 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.851 </td>\n   <td style=\"text-align:right;\"> 0.325 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.808 </td>\n   <td style=\"text-align:right;\"> 0.317 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.791 </td>\n   <td style=\"text-align:right;\"> 0.314 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.789 </td>\n   <td style=\"text-align:right;\"> 0.322 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.825 </td>\n   <td style=\"text-align:right;\"> 0.357 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.788 </td>\n   <td style=\"text-align:right;\"> 0.306 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.812 </td>\n   <td style=\"text-align:right;\"> 0.319 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeII-pgoodcovs-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-pgoodcovs-05\n\nd_05 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(p_good_covs, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by p_good_covs, b_x = 0.5\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by p_good_covs, b_x = 0.5</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> p_good_covs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.593 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.687 </td>\n   <td style=\"text-align:right;\"> 0.144 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.581 </td>\n   <td style=\"text-align:right;\"> 0.125 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.117 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.123 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.608 </td>\n   <td style=\"text-align:right;\"> 0.139 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.117 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.598 </td>\n   <td style=\"text-align:right;\"> 0.133 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.591 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.674 </td>\n   <td style=\"text-align:right;\"> 0.121 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.570 </td>\n   <td style=\"text-align:right;\"> 0.107 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.542 </td>\n   <td style=\"text-align:right;\"> 0.102 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.546 </td>\n   <td style=\"text-align:right;\"> 0.112 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.607 </td>\n   <td style=\"text-align:right;\"> 0.134 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.542 </td>\n   <td style=\"text-align:right;\"> 0.100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.588 </td>\n   <td style=\"text-align:right;\"> 0.114 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.595 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.666 </td>\n   <td style=\"text-align:right;\"> 0.110 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.567 </td>\n   <td style=\"text-align:right;\"> 0.100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.537 </td>\n   <td style=\"text-align:right;\"> 0.097 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.546 </td>\n   <td style=\"text-align:right;\"> 0.109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.598 </td>\n   <td style=\"text-align:right;\"> 0.135 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.540 </td>\n   <td style=\"text-align:right;\"> 0.092 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.569 </td>\n   <td style=\"text-align:right;\"> 0.102 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeII-rycov-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-rycov-03\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(r_ycov, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by correlations, b_x = 0.3\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by correlations, b_x = 0.3</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r_ycov </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.148 </td>\n   <td style=\"text-align:right;\"> 0.824 </td>\n   <td style=\"text-align:right;\"> 0.485 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.078 </td>\n   <td style=\"text-align:right;\"> 0.860 </td>\n   <td style=\"text-align:right;\"> 0.442 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.074 </td>\n   <td style=\"text-align:right;\"> 0.816 </td>\n   <td style=\"text-align:right;\"> 0.429 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.073 </td>\n   <td style=\"text-align:right;\"> 0.801 </td>\n   <td style=\"text-align:right;\"> 0.421 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.083 </td>\n   <td style=\"text-align:right;\"> 0.801 </td>\n   <td style=\"text-align:right;\"> 0.425 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.090 </td>\n   <td style=\"text-align:right;\"> 0.831 </td>\n   <td style=\"text-align:right;\"> 0.450 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.072 </td>\n   <td style=\"text-align:right;\"> 0.800 </td>\n   <td style=\"text-align:right;\"> 0.415 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.074 </td>\n   <td style=\"text-align:right;\"> 0.824 </td>\n   <td style=\"text-align:right;\"> 0.434 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.148 </td>\n   <td style=\"text-align:right;\"> 0.823 </td>\n   <td style=\"text-align:right;\"> 0.485 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.790 </td>\n   <td style=\"text-align:right;\"> 0.270 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.781 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.773 </td>\n   <td style=\"text-align:right;\"> 0.252 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.772 </td>\n   <td style=\"text-align:right;\"> 0.258 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.805 </td>\n   <td style=\"text-align:right;\"> 0.287 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.769 </td>\n   <td style=\"text-align:right;\"> 0.248 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.787 </td>\n   <td style=\"text-align:right;\"> 0.264 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeII-rycov-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-rycov-05\n\nd_05 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(r_ycov, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by correlations, b_x = 0.5\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by correlations, b_x = 0.5</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r_ycov </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.595 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.687 </td>\n   <td style=\"text-align:right;\"> 0.170 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.581 </td>\n   <td style=\"text-align:right;\"> 0.154 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.146 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.153 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.608 </td>\n   <td style=\"text-align:right;\"> 0.172 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.142 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.598 </td>\n   <td style=\"text-align:right;\"> 0.159 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.594 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.516 </td>\n   <td style=\"text-align:right;\"> 0.080 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.499 </td>\n   <td style=\"text-align:right;\"> 0.067 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.488 </td>\n   <td style=\"text-align:right;\"> 0.065 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.486 </td>\n   <td style=\"text-align:right;\"> 0.076 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.563 </td>\n   <td style=\"text-align:right;\"> 0.100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.487 </td>\n   <td style=\"text-align:right;\"> 0.064 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.516 </td>\n   <td style=\"text-align:right;\"> 0.074 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### TPR & FPR\n\n\n\n::: {#tbl-tpr-0 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-tpr-0\n\nd_0 |> \n  group_by(method) |> \n  summarise(covs_tpr_mean = sprintf(\"%.3f\", mean(covs_tpr)),\n            .groups = \"drop\") |> \n  kbl(caption = \"TPR, b_x = 0\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>TPR, b_x = 0</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> covs_tpr_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:left;\"> 1.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:left;\"> 0.496 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:left;\"> 0.947 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:left;\"> 0.945 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:left;\"> 0.641 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:left;\"> 0.643 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:left;\"> 0.888 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:left;\"> 0.888 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#cell-fig-tpr-0 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-tpr-0\n\nd_0 |> \n  mutate(n_good_covs = n_covs * p_good_covs) |> \n  group_by(method, n_good_covs) |> \n  summarise(covs_tpr_mean = mean(covs_tpr),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_good_covs, y = covs_tpr_mean, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15)) +\n  labs(y = \"True Positive Rate\",\n       title = \"TPR by n_good_covs, b_x = 0\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-tpr-0-1.png){#fig-tpr-0 width=672}\n:::\n:::\n\n::: {#tbl-tpr-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-tpr-03\n\nd_03 |> \n  group_by(method) |> \n  summarise(covs_tpr_mean = sprintf(\"%.3f\", mean(covs_tpr)),\n            .groups = \"drop\") |> \n  kbl(caption = \"TPR, b_x = 0.3\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>TPR, b_x = 0.3</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> covs_tpr_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:left;\"> 1.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:left;\"> 0.656 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:left;\"> 0.944 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:left;\"> 0.945 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:left;\"> 0.641 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:left;\"> 0.635 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:left;\"> 0.888 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:left;\"> 0.884 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#cell-fig-tpr-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-tpr-03\n\nd_03 |> \n  mutate(n_good_covs = n_covs * p_good_covs) |> \n  group_by(method, n_good_covs) |> \n  summarise(covs_tpr_mean = mean(covs_tpr),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_good_covs, y = covs_tpr_mean, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15)) +\n  labs(y = \"True Positive Rate\",\n       title = \"TPR by n_good_covs, b_x = 0.3\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-tpr-03-1.png){#fig-tpr-03 width=672}\n:::\n:::\n\n::: {#tbl-tpr-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-tpr-05\n\nd_05 |> \n  group_by(method) |> \n  summarise(covs_tpr_mean = sprintf(\"%.3f\", mean(covs_tpr)),\n            .groups = \"drop\") |> \n  kbl(caption = \"TPR, b_x = 0.5\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>TPR, b_x = 0.5</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> covs_tpr_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:left;\"> 1.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:left;\"> 0.747 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:left;\"> 0.940 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:left;\"> 0.945 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:left;\"> 0.641 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:left;\"> 0.620 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:left;\"> 0.888 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:left;\"> 0.877 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#cell-fig-tpr-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-tpr-05\n\nd_05 |> \n  mutate(n_good_covs = n_covs * p_good_covs) |> \n  group_by(method, n_good_covs) |> \n  summarise(covs_tpr_mean = mean(covs_tpr),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_good_covs, y = covs_tpr_mean, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15)) +\n  labs(y = \"True Positive Rate\",\n       title = \"TPR by n_good_covs, b_x = 0.5\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-tpr-05-1.png){#fig-tpr-05 width=672}\n:::\n:::\n\n::: {#tbl-fpr-0 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-fpr-0\n\nd_0 |> \n  group_by(method) |> \n  summarise(covs_fpr_mean = sprintf(\"%.3f\", mean(covs_fpr)),\n            .groups = \"drop\") |> \n  kbl(caption = \"FPR, b_x = 0\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>FPR, b_x = 0</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> covs_fpr_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:left;\"> 1.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:left;\"> 0.466 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:left;\"> 0.313 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:left;\"> 0.310 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#cell-fig-fpr-0 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-fpr-0\n\nd_0 |> \n  mutate(n_good_covs = n_covs * p_good_covs) |> \n  group_by(method, n_good_covs) |> \n  summarise(covs_fpr_mean = mean(covs_fpr),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_good_covs, y = covs_fpr_mean, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15)) +\n  labs(y = \"False Positive Rate\",\n       title = \"FPR by n_good_covs, b_x = 0\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-fpr-0-1.png){#fig-fpr-0 width=672}\n:::\n:::\n\n::: {#tbl-fpr-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-fpr-03\n\nd_03 |> \n  group_by(method) |> \n  summarise(covs_fpr_mean = sprintf(\"%.3f\", mean(covs_fpr)),\n            .groups = \"drop\") |> \n  kbl(caption = \"FPR, b_x = 0.3\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>FPR, b_x = 0.3</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> covs_fpr_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:left;\"> 1.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:left;\"> 0.415 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:left;\"> 0.314 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:left;\"> 0.308 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#cell-fig-fpr-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-fpr-03\n\nd_03 |> \n  mutate(n_good_covs = n_covs * p_good_covs) |> \n  group_by(method, n_good_covs) |> \n  summarise(covs_fpr_mean = mean(covs_fpr),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_good_covs, y = covs_fpr_mean, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15)) +\n  labs(y = \"False Positive Rate\",\n       title = \"FPR by n_good_covs, b_x = 0.3\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-fpr-03-1.png){#fig-fpr-03 width=672}\n:::\n:::\n\n::: {#tbl-fpr-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-fpr-05\n\nd_05 |> \n  group_by(method) |> \n  summarise(covs_fpr_mean = sprintf(\"%.3f\", mean(covs_fpr)),\n            .groups = \"drop\") |> \n  kbl(caption = \"FPR, b_x = 0.5\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>FPR, b_x = 0.5</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> covs_fpr_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:left;\"> 1.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:left;\"> 0.375 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:left;\"> 0.313 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:left;\"> 0.304 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#cell-fig-fpr-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-fpr-05\n\nd_05 |> \n  mutate(n_good_covs = n_covs * p_good_covs) |> \n  group_by(method, n_good_covs) |> \n  summarise(covs_fpr_mean = mean(covs_fpr),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_good_covs, y = covs_fpr_mean, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15)) +\n  labs(y = \"False Positive Rate\",\n       title = \"FPR by n_good_covs, b_x = 0.5\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-fpr-05-1.png){#fig-fpr-05 width=672}\n:::\n:::\n\n::: {#tbl-est-sd-se-0 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-est-sd-se-0\n\nd_0 |> \n  group_by(method) |> \n  summarise(mean_estimate = sprintf(\"%.3f\", mean(estimate)*-1),\n            SD_estimate = sd(estimate),\n            SE_mean = sqrt(mean(SE^2)),\n            difference = SD_estimate - SE_mean) |> \n  kbl(caption = \"b_x = 0\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>b_x = 0</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> mean_estimate </th>\n   <th style=\"text-align:right;\"> SD_estimate </th>\n   <th style=\"text-align:right;\"> SE_mean </th>\n   <th style=\"text-align:right;\"> difference </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:left;\"> -0.000 </td>\n   <td style=\"text-align:right;\"> 0.178 </td>\n   <td style=\"text-align:right;\"> 0.178 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.155 </td>\n   <td style=\"text-align:right;\"> 0.155 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p_hacked </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.238 </td>\n   <td style=\"text-align:right;\"> 0.157 </td>\n   <td style=\"text-align:right;\"> 0.080 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.145 </td>\n   <td style=\"text-align:right;\"> 0.145 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.147 </td>\n   <td style=\"text-align:right;\"> 0.145 </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.156 </td>\n   <td style=\"text-align:right;\"> 0.147 </td>\n   <td style=\"text-align:right;\"> 0.008 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.147 </td>\n   <td style=\"text-align:right;\"> 0.147 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.150 </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n   <td style=\"text-align:right;\"> 0.007 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-est-sd-se-03 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-est-sd-se-03\n\nd_03 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method) |> \n  summarise(mean_estimate = mean(estimate),\n            SD_estimate = sd(estimate),\n            mean_SE = sqrt(mean(SE^2)),\n            difference = SD_estimate - mean_SE) |> \n  kbl(caption = \"Estimate, SD, SE: b_x = 0.3\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Estimate, SD, SE: b_x = 0.3</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> mean_estimate </th>\n   <th style=\"text-align:right;\"> SD_estimate </th>\n   <th style=\"text-align:right;\"> mean_SE </th>\n   <th style=\"text-align:right;\"> difference </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.300 </td>\n   <td style=\"text-align:right;\"> 0.178 </td>\n   <td style=\"text-align:right;\"> 0.178 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.300 </td>\n   <td style=\"text-align:right;\"> 0.155 </td>\n   <td style=\"text-align:right;\"> 0.155 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.297 </td>\n   <td style=\"text-align:right;\"> 0.145 </td>\n   <td style=\"text-align:right;\"> 0.145 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.300 </td>\n   <td style=\"text-align:right;\"> 0.147 </td>\n   <td style=\"text-align:right;\"> 0.145 </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.300 </td>\n   <td style=\"text-align:right;\"> 0.156 </td>\n   <td style=\"text-align:right;\"> 0.147 </td>\n   <td style=\"text-align:right;\"> 0.008 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.287 </td>\n   <td style=\"text-align:right;\"> 0.149 </td>\n   <td style=\"text-align:right;\"> 0.148 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.300 </td>\n   <td style=\"text-align:right;\"> 0.150 </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n   <td style=\"text-align:right;\"> 0.007 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.292 </td>\n   <td style=\"text-align:right;\"> 0.144 </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-est-sd-se-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-est-sd-se-05\n\nd_05 |> \n  filter(method != \"p_hacked\") |> \n  group_by(method) |> \n  summarise(mean_estimate = mean(estimate),\n            SD_estimate = sd(estimate),\n            mean_SE = sqrt(mean(SE^2)),\n            difference = SD_estimate - mean_SE) |> \n  kbl(caption = \"Estimate, SD, SE: b_x = 0.5\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Estimate, SD, SE: b_x = 0.5</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> mean_estimate </th>\n   <th style=\"text-align:right;\"> SD_estimate </th>\n   <th style=\"text-align:right;\"> mean_SE </th>\n   <th style=\"text-align:right;\"> difference </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> no_covs </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.178 </td>\n   <td style=\"text-align:right;\"> 0.178 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> all_covs </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.155 </td>\n   <td style=\"text-align:right;\"> 0.155 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> r </td>\n   <td style=\"text-align:right;\"> 0.495 </td>\n   <td style=\"text-align:right;\"> 0.145 </td>\n   <td style=\"text-align:right;\"> 0.145 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> partial_r </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.147 </td>\n   <td style=\"text-align:right;\"> 0.145 </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.155 </td>\n   <td style=\"text-align:right;\"> 0.147 </td>\n   <td style=\"text-align:right;\"> 0.008 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> full_lm_wo_x </td>\n   <td style=\"text-align:right;\"> 0.479 </td>\n   <td style=\"text-align:right;\"> 0.151 </td>\n   <td style=\"text-align:right;\"> 0.148 </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.150 </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n   <td style=\"text-align:right;\"> 0.007 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> lasso_wo_x </td>\n   <td style=\"text-align:right;\"> 0.487 </td>\n   <td style=\"text-align:right;\"> 0.144 </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n",
    "supporting": [
      "supplement_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}