{
  "hash": "056f3ba9279c6c54c22ff05d4d9e2c55",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Supplemental Material\"\ndate: last-modified\nnumber-sections: true\nformat: \n  html: \n    embed-resources: true\n    toc: true \n    toc_depth: 5\nexecute:\n  echo: false\neditor_options: \n  chunk_output_type: console\n---\n\n\n\nThis file contains the supplemental materials for *Title of paper*. It includes all supplemental figures and tables. Additional materials are made available on our study's OSF page ([https://osf.io/zh5gn/](https://osf.io/zh5gn/)).   \n\n-----\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(dplyr) |> suppressMessages()\nlibrary(skimr)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'skimr' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(purrr)\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'ggplot2' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(patchwork)\nlibrary(ggpattern)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'ggpattern' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(forcats)\nlibrary(kableExtra, exclude = (\"group_rows\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'kableExtra' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\ntheme_set(theme_classic())\n\n\n\nmethod_colors <- c(\"No covariates\" = \"#FF7D00\",\n                   \"All covariates\" = \"#9E5900\",\n                   \"p-hacking\" = \"#C92C04\",\n                   \"Single covariate lm\" = \"#5489BA\",\n                   \"Single covariate lm with X\" = \"#5489BA\",\n                   \"All covariates lm\" = \"#664896\",\n                   \"All covariates lm with X\" = \"#664896\",\n                   \"All covariates LASSO\" = \"#4A7C59\",\n                   \"All covariates LASSO with X\" = \"#4A7C59\")\n\n\nmethod_linetypes <- c(\"No covariates\" = \"solid\",\n                     \"All covariates\" = \"solid\",\n                     \"p-hacking\" = \"solid\",\n                     \"Single covariate lm\" = \"dashed\",\n                     \"Single covariate lm with X\" = \"solid\",\n                     \"All covariates lm\" = \"dashed\",\n                     \"All covariates lm with X\" = \"solid\",\n                     \"All covariates LASSO\" = \"dashed\",\n                     \"All covariates LASSO with X\" = \"solid\")\n\nmethod_linewidths <- c(\"No covariates\" = .75,\n                     \"All covariates\" = .75,\n                     \"p-hacking\" = .5,\n                     \"Single covariate lm\" = .5,\n                     \"Single covariate lm with X\" = .5,\n                     \"All covariates lm\" = .5,\n                     \"All covariates lm with X\" = .5,\n                     \"All covariates LASSO\" = .5,\n                     \"All covariates LASSO with X\" = .5)\n\nmethod_patterns <- c(\"No covariates\" = \"none\",\n                     \"All covariates\" = \"none\",\n                     \"p-hacking\" = \"none\",\n                     \"Single covariate lm\" = \"stripe\",\n                     \"Single covariate lm with X\" = \"none\",\n                     \"All covariates lm\" = \"stripe\",\n                     \"All covariates lm with X\" = \"none\",\n                     \"All covariates LASSO\" = \"stripe\",\n                     \"All covariates LASSO with X\" = \"none\")\n\ndevtools::source_url(\"https://github.com/jjcurtin/lab_support/blob/main/format_path.R?raw=true\") |> suppressMessages()\n\n# rdrive_path <- format_path(\"cov/raw_data\")\n\nrdrive_path <- \"\\\\\\\\research.drive.wisc.edu\\\\jjcurtin\\\\studydata\\\\cov\\\\raw_data\"\n\noptions(digits = 3)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: read in data\n\nd_0 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_method_0.csv\"))\nd_05 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_method_05.csv\"))\n\nd_20_covs <- data.table::fread(here::here(rdrive_path, \"batch_results_20_covs.csv\"))\nd_n50 <- data.table::fread(here::here(rdrive_path, \"batch_results_n50.csv\"))\n\nd2_0 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_20K_0.csv\"))\nd2_05 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_20K_05.csv\"))\n\nd_wo_x_0 <- data.table::fread(here::here(rdrive_path, \"batch_results_methods_wo_x_seed0.csv\"))\nd_wo_x_1 <- data.table::fread(here::here(rdrive_path, \"batch_results_methods_wo_x_seed1.csv\"))\n\nd_02_0 <- data.table::fread(here::here(rdrive_path, \"batch_results_02_seed0.csv\"))\nd_02_1 <- data.table::fread(here::here(rdrive_path, \"batch_results_02_seed1.csv\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: combine data\n\nd_0 <- rbind(d_0, d_20_covs |> filter(b_x == 0))\nd_0 <- rbind(d_0, d_n50 |> filter(b_x == 0))\n\nd_05 <- rbind(d_05, d_20_covs |> filter(b_x == 0.5))\nd_05 <- rbind(d_05, d_n50 |> filter(b_x == 0.5))\n\nrm(d_20_covs, d_n50)\n\nd_0 <- rbind(d_0, d2_0)\nd_05 <- rbind(d_05, d2_05)\n\nrm(d2_0, d2_05)\n\nd_0 <- rbind(d_0, d_wo_x_0 |> filter(b_x == 0))\nd_0 <- rbind(d_0, d_wo_x_1 |> filter(b_x == 0))\n\nd_05 <- rbind(d_05, d_wo_x_0 |> filter(b_x == 0.5))\nd_05 <- rbind(d_05, d_wo_x_1 |> filter(b_x == 0.5))\n\nrm(d_wo_x_0, d_wo_x_1)\n\nd_02 <- rbind(d_02_0, d_02_1)\n\nrm(d_02_0, d_02_1)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: factor levels\n\nd_0 <- d_0 |> \n  mutate(method = factor(method, levels = c(\"no_covs\", \"all_covs\",\"p_hacked\",  \"r\",\n                                            \"partial_r\", \"full_lm_wo_x\", \"full_lm\",  \n                                           \"lasso_wo_x\", \"lasso\"),\n                         labels = c(\"No covariates\", \"All covariates\", \"p-hacking\", \n                                    \"Single covariate lm\", \"Single covariate lm with X\", \n                                    \"All covariates lm\", \"All covariates lm with X\", \n                                            \"All covariates LASSO\", \"All covariates LASSO with X\")))\n\nd_02 <- d_02 |> \n  mutate(method = factor(method, levels = c(\"no_covs\", \"all_covs\",\"p_hacked\",   \"r\", \n                                            \"partial_r\", \"full_lm_wo_x\", \"full_lm\",  \n                                           \"lasso_wo_x\", \"lasso\"),\n                         labels = c( \"No covariates\", \"All covariates\", \"p-hacking\", \n                                    \"Single covariate lm\", \"Single covariate lm with X\", \n                                    \"All covariates lm\", \"All covariates lm with X\", \n                                            \"All covariates LASSO\", \"All covariates LASSO with X\")))\n\nd_05 <- d_05 |> \n  mutate(method = factor(method, levels = c(\"no_covs\", \"all_covs\",\"p_hacked\",   \"r\", \n                                            \"partial_r\", \"full_lm_wo_x\", \"full_lm\",  \n                                           \"lasso_wo_x\", \"lasso\"),\n                         labels = c(\"No covariates\", \"All covariates\", \"p-hacking\", \n                                    \"Single covariate lm\", \"Single covariate lm with X\", \n                                    \"All covariates lm\", \"All covariates lm with X\", \n                                            \"All covariates LASSO\", \"All covariates LASSO with X\")))\n```\n:::\n\n\n\n### Type I error\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: histogram variable 0\n\nh0 <- d_0 |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(type_I = mean(p_value < 0.05),\n            .groups = \"drop\")\n```\n:::\n\n::: {#cell-fig-histogram-phack .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-histogram-phack\n\nh0 |>\n  filter(method == \"p-hacking\") |> \n  ggplot(aes(x = type_I)) +\n  geom_histogram() +\n  facet_wrap(~ method) +\n  labs(x = \"Type I Error\",\n       title = \"Distribution of Type I error: p-hacked\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-histogram-phack-1.png){#fig-histogram-phack width=672}\n:::\n:::\n\n::: {#cell-fig-histograms-all-0 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-histograms-all-0\n\nh0 |>\n  filter(method != \"p-hacking\") |> \n  ggplot(aes(x = type_I)) +\n  geom_histogram() +\n  facet_wrap(~ method) +\n  labs(x = \"Type I Error\",\n       title = \"Distribution of Type I error\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-histograms-all-0-1.png){#fig-histograms-all-0 width=672}\n:::\n:::\n\n::: {#tbl-typeI-nobs .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeI-nobs \n\nd_0 |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  group_by(n_obs, method) |> \n  summarise(typeI_min = min(prop_sig),\n            typeI_max = max(prop_sig),\n            typeI_mean = mean(prop_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type I error by n_obs\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type I error by n_obs</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> n_obs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeI_min </th>\n   <th style=\"text-align:right;\"> typeI_max </th>\n   <th style=\"text-align:right;\"> typeI_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.084 </td>\n   <td style=\"text-align:right;\"> 0.426 </td>\n   <td style=\"text-align:right;\"> 0.215 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.072 </td>\n   <td style=\"text-align:right;\"> 0.057 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.096 </td>\n   <td style=\"text-align:right;\"> 0.074 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.089 </td>\n   <td style=\"text-align:right;\"> 0.069 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.078 </td>\n   <td style=\"text-align:right;\"> 0.449 </td>\n   <td style=\"text-align:right;\"> 0.203 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.059 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n   <td style=\"text-align:right;\"> 0.087 </td>\n   <td style=\"text-align:right;\"> 0.064 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n   <td style=\"text-align:right;\"> 0.067 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.076 </td>\n   <td style=\"text-align:right;\"> 0.454 </td>\n   <td style=\"text-align:right;\"> 0.198 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.081 </td>\n   <td style=\"text-align:right;\"> 0.059 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n   <td style=\"text-align:right;\"> 0.055 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.074 </td>\n   <td style=\"text-align:right;\"> 0.456 </td>\n   <td style=\"text-align:right;\"> 0.194 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.059 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.073 </td>\n   <td style=\"text-align:right;\"> 0.455 </td>\n   <td style=\"text-align:right;\"> 0.189 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.061 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n   <td style=\"text-align:right;\"> 0.462 </td>\n   <td style=\"text-align:right;\"> 0.186 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.055 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeI-ncovs .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeI-ncovs\n\nd_0 |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  group_by(n_covs, method) |> \n  summarise(typeI_min = min(prop_sig),\n            typeI_max = max(prop_sig),\n            typeI_mean = mean(prop_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type I error by n_covs\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type I error by n_covs</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> n_covs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeI_min </th>\n   <th style=\"text-align:right;\"> typeI_max </th>\n   <th style=\"text-align:right;\"> typeI_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n   <td style=\"text-align:right;\"> 0.140 </td>\n   <td style=\"text-align:right;\"> 0.098 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.094 </td>\n   <td style=\"text-align:right;\"> 0.238 </td>\n   <td style=\"text-align:right;\"> 0.150 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.082 </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.067 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.117 </td>\n   <td style=\"text-align:right;\"> 0.329 </td>\n   <td style=\"text-align:right;\"> 0.201 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.064 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.093 </td>\n   <td style=\"text-align:right;\"> 0.060 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.074 </td>\n   <td style=\"text-align:right;\"> 0.057 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.139 </td>\n   <td style=\"text-align:right;\"> 0.404 </td>\n   <td style=\"text-align:right;\"> 0.249 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.069 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n   <td style=\"text-align:right;\"> 0.094 </td>\n   <td style=\"text-align:right;\"> 0.064 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n   <td style=\"text-align:right;\"> 0.080 </td>\n   <td style=\"text-align:right;\"> 0.059 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.165 </td>\n   <td style=\"text-align:right;\"> 0.462 </td>\n   <td style=\"text-align:right;\"> 0.290 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.072 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.096 </td>\n   <td style=\"text-align:right;\"> 0.066 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.089 </td>\n   <td style=\"text-align:right;\"> 0.061 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeI-pgoodcovs .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeI-pgoodcovs\n\nd_0 |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  group_by(p_good_covs, method) |> \n  summarise(typeI_min = min(prop_sig),\n            typeI_max = max(prop_sig),\n            typeI_mean = mean(prop_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type I error by p_good_covs\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type I error by p_good_covs</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> p_good_covs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeI_min </th>\n   <th style=\"text-align:right;\"> typeI_max </th>\n   <th style=\"text-align:right;\"> typeI_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n   <td style=\"text-align:right;\"> 0.344 </td>\n   <td style=\"text-align:right;\"> 0.163 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.072 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.090 </td>\n   <td style=\"text-align:right;\"> 0.057 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.089 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.084 </td>\n   <td style=\"text-align:right;\"> 0.400 </td>\n   <td style=\"text-align:right;\"> 0.202 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.063 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.094 </td>\n   <td style=\"text-align:right;\"> 0.060 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.084 </td>\n   <td style=\"text-align:right;\"> 0.057 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.093 </td>\n   <td style=\"text-align:right;\"> 0.462 </td>\n   <td style=\"text-align:right;\"> 0.227 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.059 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.096 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.081 </td>\n   <td style=\"text-align:right;\"> 0.055 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeI-rycov .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeI-rycov\n\nd_0 |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  group_by(r_ycov, method) |> \n  summarise(typeI_min = min(prop_sig),\n            typeI_max = max(prop_sig),\n            typeI_mean = mean(prop_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type I error by y-cov correlations\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type I error by y-cov correlations</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r_ycov </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeI_min </th>\n   <th style=\"text-align:right;\"> typeI_max </th>\n   <th style=\"text-align:right;\"> typeI_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n   <td style=\"text-align:right;\"> 0.276 </td>\n   <td style=\"text-align:right;\"> 0.145 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.072 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.075 </td>\n   <td style=\"text-align:right;\"> 0.059 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n   <td style=\"text-align:right;\"> 0.085 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:right;\"> 0.082 </td>\n   <td style=\"text-align:right;\"> 0.462 </td>\n   <td style=\"text-align:right;\"> 0.250 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n   <td style=\"text-align:right;\"> 0.051 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.096 </td>\n   <td style=\"text-align:right;\"> 0.060 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> 0.089 </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### Type II error\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: histograms variable 02\n\nh02 <- d_02 |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(type_II = mean(p_value >= 0.05),\n            .groups = \"drop\")\n```\n:::\n\n::: {#cell-fig-histograms-all-02 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-histograms-all-02\n\nh02 |>\n  filter(method != \"p-hacking\") |> \n  ggplot(aes(x = type_II)) +\n  geom_histogram() +\n  facet_wrap(~ method) +\n  labs(x = \"Type II Error\",\n       title = \"Distribution of Type II error, b_x = 0.2\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-histograms-all-02-1.png){#fig-histograms-all-02 width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: histograms variable 05\n\nh05 <- d_05 |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(type_II = mean(p_value >= 0.05),\n            .groups = \"drop\")\n```\n:::\n\n::: {#cell-fig-histograms-all-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-histograms-all-05\n\nh05 |>\n  filter(method != \"p-hacking\") |> \n  ggplot(aes(x = type_II)) +\n  geom_histogram() +\n  facet_wrap(~ method) +\n  labs(x = \"Type II Error\",\n       title = \"Distribution of Type II error, b_x = 0.5\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-histograms-all-05-1.png){#fig-histograms-all-05 width=672}\n:::\n:::\n\n::: {#tbl-typeII-nobs-02 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-nobs-02\n\nd_02 |> \n  filter(method != \"p-hacking\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(n_obs, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by n_obs, b_x = 0.2\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by n_obs, b_x = 0.2</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> n_obs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.890 </td>\n   <td style=\"text-align:right;\"> 0.897 </td>\n   <td style=\"text-align:right;\"> 0.894 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.821 </td>\n   <td style=\"text-align:right;\"> 0.911 </td>\n   <td style=\"text-align:right;\"> 0.875 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.808 </td>\n   <td style=\"text-align:right;\"> 0.893 </td>\n   <td style=\"text-align:right;\"> 0.862 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.803 </td>\n   <td style=\"text-align:right;\"> 0.881 </td>\n   <td style=\"text-align:right;\"> 0.849 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.857 </td>\n   <td style=\"text-align:right;\"> 0.899 </td>\n   <td style=\"text-align:right;\"> 0.884 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.784 </td>\n   <td style=\"text-align:right;\"> 0.880 </td>\n   <td style=\"text-align:right;\"> 0.840 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.805 </td>\n   <td style=\"text-align:right;\"> 0.897 </td>\n   <td style=\"text-align:right;\"> 0.867 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.751 </td>\n   <td style=\"text-align:right;\"> 0.878 </td>\n   <td style=\"text-align:right;\"> 0.832 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.828 </td>\n   <td style=\"text-align:right;\"> 0.836 </td>\n   <td style=\"text-align:right;\"> 0.832 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.614 </td>\n   <td style=\"text-align:right;\"> 0.835 </td>\n   <td style=\"text-align:right;\"> 0.763 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.596 </td>\n   <td style=\"text-align:right;\"> 0.823 </td>\n   <td style=\"text-align:right;\"> 0.752 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.594 </td>\n   <td style=\"text-align:right;\"> 0.817 </td>\n   <td style=\"text-align:right;\"> 0.746 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.699 </td>\n   <td style=\"text-align:right;\"> 0.832 </td>\n   <td style=\"text-align:right;\"> 0.778 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.612 </td>\n   <td style=\"text-align:right;\"> 0.817 </td>\n   <td style=\"text-align:right;\"> 0.741 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.602 </td>\n   <td style=\"text-align:right;\"> 0.824 </td>\n   <td style=\"text-align:right;\"> 0.758 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.577 </td>\n   <td style=\"text-align:right;\"> 0.815 </td>\n   <td style=\"text-align:right;\"> 0.737 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.766 </td>\n   <td style=\"text-align:right;\"> 0.775 </td>\n   <td style=\"text-align:right;\"> 0.770 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.428 </td>\n   <td style=\"text-align:right;\"> 0.760 </td>\n   <td style=\"text-align:right;\"> 0.657 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.414 </td>\n   <td style=\"text-align:right;\"> 0.759 </td>\n   <td style=\"text-align:right;\"> 0.647 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.413 </td>\n   <td style=\"text-align:right;\"> 0.755 </td>\n   <td style=\"text-align:right;\"> 0.643 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.521 </td>\n   <td style=\"text-align:right;\"> 0.763 </td>\n   <td style=\"text-align:right;\"> 0.670 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.443 </td>\n   <td style=\"text-align:right;\"> 0.755 </td>\n   <td style=\"text-align:right;\"> 0.642 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.422 </td>\n   <td style=\"text-align:right;\"> 0.760 </td>\n   <td style=\"text-align:right;\"> 0.653 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.407 </td>\n   <td style=\"text-align:right;\"> 0.754 </td>\n   <td style=\"text-align:right;\"> 0.638 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.704 </td>\n   <td style=\"text-align:right;\"> 0.716 </td>\n   <td style=\"text-align:right;\"> 0.709 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.287 </td>\n   <td style=\"text-align:right;\"> 0.688 </td>\n   <td style=\"text-align:right;\"> 0.561 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.276 </td>\n   <td style=\"text-align:right;\"> 0.686 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.275 </td>\n   <td style=\"text-align:right;\"> 0.684 </td>\n   <td style=\"text-align:right;\"> 0.549 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.363 </td>\n   <td style=\"text-align:right;\"> 0.687 </td>\n   <td style=\"text-align:right;\"> 0.570 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.300 </td>\n   <td style=\"text-align:right;\"> 0.684 </td>\n   <td style=\"text-align:right;\"> 0.550 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.284 </td>\n   <td style=\"text-align:right;\"> 0.687 </td>\n   <td style=\"text-align:right;\"> 0.557 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.275 </td>\n   <td style=\"text-align:right;\"> 0.682 </td>\n   <td style=\"text-align:right;\"> 0.546 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.588 </td>\n   <td style=\"text-align:right;\"> 0.597 </td>\n   <td style=\"text-align:right;\"> 0.593 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.116 </td>\n   <td style=\"text-align:right;\"> 0.565 </td>\n   <td style=\"text-align:right;\"> 0.404 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.111 </td>\n   <td style=\"text-align:right;\"> 0.562 </td>\n   <td style=\"text-align:right;\"> 0.397 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.111 </td>\n   <td style=\"text-align:right;\"> 0.561 </td>\n   <td style=\"text-align:right;\"> 0.395 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n   <td style=\"text-align:right;\"> 0.562 </td>\n   <td style=\"text-align:right;\"> 0.409 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.123 </td>\n   <td style=\"text-align:right;\"> 0.561 </td>\n   <td style=\"text-align:right;\"> 0.397 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.115 </td>\n   <td style=\"text-align:right;\"> 0.564 </td>\n   <td style=\"text-align:right;\"> 0.401 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.112 </td>\n   <td style=\"text-align:right;\"> 0.561 </td>\n   <td style=\"text-align:right;\"> 0.395 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.481 </td>\n   <td style=\"text-align:right;\"> 0.491 </td>\n   <td style=\"text-align:right;\"> 0.487 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> 0.452 </td>\n   <td style=\"text-align:right;\"> 0.288 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.041 </td>\n   <td style=\"text-align:right;\"> 0.450 </td>\n   <td style=\"text-align:right;\"> 0.283 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.041 </td>\n   <td style=\"text-align:right;\"> 0.449 </td>\n   <td style=\"text-align:right;\"> 0.282 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.451 </td>\n   <td style=\"text-align:right;\"> 0.291 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> 0.449 </td>\n   <td style=\"text-align:right;\"> 0.284 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> 0.452 </td>\n   <td style=\"text-align:right;\"> 0.286 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.041 </td>\n   <td style=\"text-align:right;\"> 0.449 </td>\n   <td style=\"text-align:right;\"> 0.282 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeII-nobs-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-nobs-05\n\nd_05 |> \n  filter(method != \"p-hacking\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(n_obs, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by n_obs, b_x = 0.5\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by n_obs, b_x = 0.5</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> n_obs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.585 </td>\n   <td style=\"text-align:right;\"> 0.595 </td>\n   <td style=\"text-align:right;\"> 0.589 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.274 </td>\n   <td style=\"text-align:right;\"> 0.687 </td>\n   <td style=\"text-align:right;\"> 0.503 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.227 </td>\n   <td style=\"text-align:right;\"> 0.581 </td>\n   <td style=\"text-align:right;\"> 0.446 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.223 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.420 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.423 </td>\n   <td style=\"text-align:right;\"> 0.608 </td>\n   <td style=\"text-align:right;\"> 0.542 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.318 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.454 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.229 </td>\n   <td style=\"text-align:right;\"> 0.598 </td>\n   <td style=\"text-align:right;\"> 0.467 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.171 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.408 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.296 </td>\n   <td style=\"text-align:right;\"> 0.308 </td>\n   <td style=\"text-align:right;\"> 0.303 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.014 </td>\n   <td style=\"text-align:right;\"> 0.304 </td>\n   <td style=\"text-align:right;\"> 0.171 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.276 </td>\n   <td style=\"text-align:right;\"> 0.151 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.268 </td>\n   <td style=\"text-align:right;\"> 0.146 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n   <td style=\"text-align:right;\"> 0.295 </td>\n   <td style=\"text-align:right;\"> 0.189 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.035 </td>\n   <td style=\"text-align:right;\"> 0.268 </td>\n   <td style=\"text-align:right;\"> 0.158 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.012 </td>\n   <td style=\"text-align:right;\"> 0.285 </td>\n   <td style=\"text-align:right;\"> 0.159 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.009 </td>\n   <td style=\"text-align:right;\"> 0.270 </td>\n   <td style=\"text-align:right;\"> 0.144 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.136 </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n   <td style=\"text-align:right;\"> 0.140 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.119 </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.115 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.113 </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 0.121 </td>\n   <td style=\"text-align:right;\"> 0.063 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n   <td style=\"text-align:right;\"> 0.113 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.114 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.114 </td>\n   <td style=\"text-align:right;\"> 0.049 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n   <td style=\"text-align:right;\"> 0.059 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.044 </td>\n   <td style=\"text-align:right;\"> 0.018 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> 0.016 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.042 </td>\n   <td style=\"text-align:right;\"> 0.016 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.044 </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.042 </td>\n   <td style=\"text-align:right;\"> 0.018 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.044 </td>\n   <td style=\"text-align:right;\"> 0.017 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> 0.016 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.008 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.009 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeII-ncovs-02 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-ncovs-02\n\nd_02 |> \n  filter(method != \"p-hacking\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(n_covs, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by n_covs, b_x = 0.2\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by n_covs, b_x = 0.2</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> n_covs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.482 </td>\n   <td style=\"text-align:right;\"> 0.896 </td>\n   <td style=\"text-align:right;\"> 0.714 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.226 </td>\n   <td style=\"text-align:right;\"> 0.893 </td>\n   <td style=\"text-align:right;\"> 0.642 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.225 </td>\n   <td style=\"text-align:right;\"> 0.893 </td>\n   <td style=\"text-align:right;\"> 0.640 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.225 </td>\n   <td style=\"text-align:right;\"> 0.881 </td>\n   <td style=\"text-align:right;\"> 0.637 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.225 </td>\n   <td style=\"text-align:right;\"> 0.895 </td>\n   <td style=\"text-align:right;\"> 0.642 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.225 </td>\n   <td style=\"text-align:right;\"> 0.880 </td>\n   <td style=\"text-align:right;\"> 0.636 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.225 </td>\n   <td style=\"text-align:right;\"> 0.893 </td>\n   <td style=\"text-align:right;\"> 0.642 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.225 </td>\n   <td style=\"text-align:right;\"> 0.878 </td>\n   <td style=\"text-align:right;\"> 0.637 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.485 </td>\n   <td style=\"text-align:right;\"> 0.897 </td>\n   <td style=\"text-align:right;\"> 0.714 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.125 </td>\n   <td style=\"text-align:right;\"> 0.895 </td>\n   <td style=\"text-align:right;\"> 0.604 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.124 </td>\n   <td style=\"text-align:right;\"> 0.890 </td>\n   <td style=\"text-align:right;\"> 0.598 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.124 </td>\n   <td style=\"text-align:right;\"> 0.872 </td>\n   <td style=\"text-align:right;\"> 0.594 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.124 </td>\n   <td style=\"text-align:right;\"> 0.893 </td>\n   <td style=\"text-align:right;\"> 0.606 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.124 </td>\n   <td style=\"text-align:right;\"> 0.870 </td>\n   <td style=\"text-align:right;\"> 0.591 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.125 </td>\n   <td style=\"text-align:right;\"> 0.893 </td>\n   <td style=\"text-align:right;\"> 0.602 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.124 </td>\n   <td style=\"text-align:right;\"> 0.868 </td>\n   <td style=\"text-align:right;\"> 0.592 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.481 </td>\n   <td style=\"text-align:right;\"> 0.895 </td>\n   <td style=\"text-align:right;\"> 0.714 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.080 </td>\n   <td style=\"text-align:right;\"> 0.900 </td>\n   <td style=\"text-align:right;\"> 0.582 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.078 </td>\n   <td style=\"text-align:right;\"> 0.890 </td>\n   <td style=\"text-align:right;\"> 0.573 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.078 </td>\n   <td style=\"text-align:right;\"> 0.869 </td>\n   <td style=\"text-align:right;\"> 0.568 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.080 </td>\n   <td style=\"text-align:right;\"> 0.895 </td>\n   <td style=\"text-align:right;\"> 0.590 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.079 </td>\n   <td style=\"text-align:right;\"> 0.865 </td>\n   <td style=\"text-align:right;\"> 0.565 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.080 </td>\n   <td style=\"text-align:right;\"> 0.893 </td>\n   <td style=\"text-align:right;\"> 0.578 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.079 </td>\n   <td style=\"text-align:right;\"> 0.859 </td>\n   <td style=\"text-align:right;\"> 0.562 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.484 </td>\n   <td style=\"text-align:right;\"> 0.897 </td>\n   <td style=\"text-align:right;\"> 0.714 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.057 </td>\n   <td style=\"text-align:right;\"> 0.904 </td>\n   <td style=\"text-align:right;\"> 0.569 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.055 </td>\n   <td style=\"text-align:right;\"> 0.892 </td>\n   <td style=\"text-align:right;\"> 0.556 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.055 </td>\n   <td style=\"text-align:right;\"> 0.872 </td>\n   <td style=\"text-align:right;\"> 0.550 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n   <td style=\"text-align:right;\"> 0.899 </td>\n   <td style=\"text-align:right;\"> 0.583 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n   <td style=\"text-align:right;\"> 0.864 </td>\n   <td style=\"text-align:right;\"> 0.548 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n   <td style=\"text-align:right;\"> 0.897 </td>\n   <td style=\"text-align:right;\"> 0.562 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.055 </td>\n   <td style=\"text-align:right;\"> 0.852 </td>\n   <td style=\"text-align:right;\"> 0.541 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.483 </td>\n   <td style=\"text-align:right;\"> 0.896 </td>\n   <td style=\"text-align:right;\"> 0.714 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> 0.911 </td>\n   <td style=\"text-align:right;\"> 0.561 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.041 </td>\n   <td style=\"text-align:right;\"> 0.890 </td>\n   <td style=\"text-align:right;\"> 0.544 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.041 </td>\n   <td style=\"text-align:right;\"> 0.877 </td>\n   <td style=\"text-align:right;\"> 0.538 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.898 </td>\n   <td style=\"text-align:right;\"> 0.580 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> 0.863 </td>\n   <td style=\"text-align:right;\"> 0.539 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> 0.896 </td>\n   <td style=\"text-align:right;\"> 0.551 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.041 </td>\n   <td style=\"text-align:right;\"> 0.844 </td>\n   <td style=\"text-align:right;\"> 0.525 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeII-ncovs-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-ncovs-05\n\nd_05 |> \n  filter(method != \"p-hacking\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(n_covs, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by n_covs, b_x = 0.5\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by n_covs, b_x = 0.5</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> n_covs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.595 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.589 </td>\n   <td style=\"text-align:right;\"> 0.134 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.581 </td>\n   <td style=\"text-align:right;\"> 0.132 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.128 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.587 </td>\n   <td style=\"text-align:right;\"> 0.137 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.129 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.588 </td>\n   <td style=\"text-align:right;\"> 0.134 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.129 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.593 </td>\n   <td style=\"text-align:right;\"> 0.183 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.605 </td>\n   <td style=\"text-align:right;\"> 0.121 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.578 </td>\n   <td style=\"text-align:right;\"> 0.114 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.539 </td>\n   <td style=\"text-align:right;\"> 0.109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.591 </td>\n   <td style=\"text-align:right;\"> 0.130 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.546 </td>\n   <td style=\"text-align:right;\"> 0.114 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.588 </td>\n   <td style=\"text-align:right;\"> 0.119 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.540 </td>\n   <td style=\"text-align:right;\"> 0.109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.594 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.624 </td>\n   <td style=\"text-align:right;\"> 0.119 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.569 </td>\n   <td style=\"text-align:right;\"> 0.106 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.520 </td>\n   <td style=\"text-align:right;\"> 0.100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.605 </td>\n   <td style=\"text-align:right;\"> 0.134 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.538 </td>\n   <td style=\"text-align:right;\"> 0.110 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.593 </td>\n   <td style=\"text-align:right;\"> 0.113 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.518 </td>\n   <td style=\"text-align:right;\"> 0.099 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.593 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.656 </td>\n   <td style=\"text-align:right;\"> 0.122 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.576 </td>\n   <td style=\"text-align:right;\"> 0.102 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.525 </td>\n   <td style=\"text-align:right;\"> 0.096 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.605 </td>\n   <td style=\"text-align:right;\"> 0.137 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.538 </td>\n   <td style=\"text-align:right;\"> 0.109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.597 </td>\n   <td style=\"text-align:right;\"> 0.109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.513 </td>\n   <td style=\"text-align:right;\"> 0.092 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.591 </td>\n   <td style=\"text-align:right;\"> 0.183 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.687 </td>\n   <td style=\"text-align:right;\"> 0.128 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.575 </td>\n   <td style=\"text-align:right;\"> 0.100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.536 </td>\n   <td style=\"text-align:right;\"> 0.094 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.608 </td>\n   <td style=\"text-align:right;\"> 0.142 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.541 </td>\n   <td style=\"text-align:right;\"> 0.111 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.598 </td>\n   <td style=\"text-align:right;\"> 0.107 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.087 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeII-pgoodcovs-02 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-pgoodcovs-02\n\nd_02 |> \n  filter(method != \"p-hacking\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(p_good_covs, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by p_good_covs, b_x = 0.2\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by p_good_covs, b_x = 0.2</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> p_good_covs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.485 </td>\n   <td style=\"text-align:right;\"> 0.897 </td>\n   <td style=\"text-align:right;\"> 0.714 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.156 </td>\n   <td style=\"text-align:right;\"> 0.911 </td>\n   <td style=\"text-align:right;\"> 0.632 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.147 </td>\n   <td style=\"text-align:right;\"> 0.892 </td>\n   <td style=\"text-align:right;\"> 0.620 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.145 </td>\n   <td style=\"text-align:right;\"> 0.881 </td>\n   <td style=\"text-align:right;\"> 0.613 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.147 </td>\n   <td style=\"text-align:right;\"> 0.899 </td>\n   <td style=\"text-align:right;\"> 0.626 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n   <td style=\"text-align:right;\"> 0.880 </td>\n   <td style=\"text-align:right;\"> 0.610 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.151 </td>\n   <td style=\"text-align:right;\"> 0.897 </td>\n   <td style=\"text-align:right;\"> 0.626 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.144 </td>\n   <td style=\"text-align:right;\"> 0.878 </td>\n   <td style=\"text-align:right;\"> 0.607 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.481 </td>\n   <td style=\"text-align:right;\"> 0.896 </td>\n   <td style=\"text-align:right;\"> 0.714 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.073 </td>\n   <td style=\"text-align:right;\"> 0.907 </td>\n   <td style=\"text-align:right;\"> 0.585 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.068 </td>\n   <td style=\"text-align:right;\"> 0.893 </td>\n   <td style=\"text-align:right;\"> 0.576 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.068 </td>\n   <td style=\"text-align:right;\"> 0.880 </td>\n   <td style=\"text-align:right;\"> 0.571 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n   <td style=\"text-align:right;\"> 0.898 </td>\n   <td style=\"text-align:right;\"> 0.593 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.068 </td>\n   <td style=\"text-align:right;\"> 0.878 </td>\n   <td style=\"text-align:right;\"> 0.569 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.072 </td>\n   <td style=\"text-align:right;\"> 0.894 </td>\n   <td style=\"text-align:right;\"> 0.581 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.069 </td>\n   <td style=\"text-align:right;\"> 0.878 </td>\n   <td style=\"text-align:right;\"> 0.565 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.483 </td>\n   <td style=\"text-align:right;\"> 0.896 </td>\n   <td style=\"text-align:right;\"> 0.714 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> 0.908 </td>\n   <td style=\"text-align:right;\"> 0.557 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.041 </td>\n   <td style=\"text-align:right;\"> 0.890 </td>\n   <td style=\"text-align:right;\"> 0.551 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.041 </td>\n   <td style=\"text-align:right;\"> 0.877 </td>\n   <td style=\"text-align:right;\"> 0.549 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.898 </td>\n   <td style=\"text-align:right;\"> 0.581 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> 0.873 </td>\n   <td style=\"text-align:right;\"> 0.548 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> 0.891 </td>\n   <td style=\"text-align:right;\"> 0.553 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.041 </td>\n   <td style=\"text-align:right;\"> 0.876 </td>\n   <td style=\"text-align:right;\"> 0.542 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeII-pgoodcovs-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-pgoodcovs-05\n\nd_05 |> \n  filter(method != \"p-hacking\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(p_good_covs, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by p_good_covs, b_x = 0.5\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by p_good_covs, b_x = 0.5</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> p_good_covs </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.593 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.687 </td>\n   <td style=\"text-align:right;\"> 0.144 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.581 </td>\n   <td style=\"text-align:right;\"> 0.125 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.117 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.608 </td>\n   <td style=\"text-align:right;\"> 0.139 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.123 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.598 </td>\n   <td style=\"text-align:right;\"> 0.133 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.117 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.591 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.674 </td>\n   <td style=\"text-align:right;\"> 0.121 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.570 </td>\n   <td style=\"text-align:right;\"> 0.107 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.542 </td>\n   <td style=\"text-align:right;\"> 0.102 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.607 </td>\n   <td style=\"text-align:right;\"> 0.134 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.546 </td>\n   <td style=\"text-align:right;\"> 0.112 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.588 </td>\n   <td style=\"text-align:right;\"> 0.114 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.542 </td>\n   <td style=\"text-align:right;\"> 0.100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.595 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.666 </td>\n   <td style=\"text-align:right;\"> 0.110 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.567 </td>\n   <td style=\"text-align:right;\"> 0.100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.537 </td>\n   <td style=\"text-align:right;\"> 0.097 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.598 </td>\n   <td style=\"text-align:right;\"> 0.135 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.546 </td>\n   <td style=\"text-align:right;\"> 0.109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.569 </td>\n   <td style=\"text-align:right;\"> 0.102 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.540 </td>\n   <td style=\"text-align:right;\"> 0.092 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeII-rycov-02 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-rycov-02\n\nd_02 |> \n  filter(method != \"p-hacking\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(r_ycov, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by correlations, b_x = 0.2\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by correlations, b_x = 0.2</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r_ycov </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.481 </td>\n   <td style=\"text-align:right;\"> 0.897 </td>\n   <td style=\"text-align:right;\"> 0.714 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.380 </td>\n   <td style=\"text-align:right;\"> 0.911 </td>\n   <td style=\"text-align:right;\"> 0.678 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.376 </td>\n   <td style=\"text-align:right;\"> 0.893 </td>\n   <td style=\"text-align:right;\"> 0.671 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.374 </td>\n   <td style=\"text-align:right;\"> 0.881 </td>\n   <td style=\"text-align:right;\"> 0.664 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.403 </td>\n   <td style=\"text-align:right;\"> 0.899 </td>\n   <td style=\"text-align:right;\"> 0.685 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.384 </td>\n   <td style=\"text-align:right;\"> 0.880 </td>\n   <td style=\"text-align:right;\"> 0.662 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.374 </td>\n   <td style=\"text-align:right;\"> 0.897 </td>\n   <td style=\"text-align:right;\"> 0.673 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.368 </td>\n   <td style=\"text-align:right;\"> 0.878 </td>\n   <td style=\"text-align:right;\"> 0.658 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.482 </td>\n   <td style=\"text-align:right;\"> 0.897 </td>\n   <td style=\"text-align:right;\"> 0.714 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> 0.881 </td>\n   <td style=\"text-align:right;\"> 0.505 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.041 </td>\n   <td style=\"text-align:right;\"> 0.880 </td>\n   <td style=\"text-align:right;\"> 0.494 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.041 </td>\n   <td style=\"text-align:right;\"> 0.874 </td>\n   <td style=\"text-align:right;\"> 0.491 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.887 </td>\n   <td style=\"text-align:right;\"> 0.516 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> 0.872 </td>\n   <td style=\"text-align:right;\"> 0.489 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> 0.882 </td>\n   <td style=\"text-align:right;\"> 0.501 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.041 </td>\n   <td style=\"text-align:right;\"> 0.869 </td>\n   <td style=\"text-align:right;\"> 0.486 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-typeII-rycov-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-typeII-rycov-05\n\nd_05 |> \n  filter(method != \"p-hacking\") |> \n  group_by(method, n_obs, n_covs, r_ycov, p_good_covs, r_cov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  group_by(r_ycov, method) |> \n  summarise(typeII_min = min(prop_not_sig),\n            typeII_max = max(prop_not_sig),\n            typeII_mean = mean(prop_not_sig),\n            .groups = \"drop\") |> \n  kbl(caption = \"Type II error by correlations, b_x = 0.5\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Type II error by correlations, b_x = 0.5</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r_ycov </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:right;\"> typeII_min </th>\n   <th style=\"text-align:right;\"> typeII_max </th>\n   <th style=\"text-align:right;\"> typeII_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.595 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.687 </td>\n   <td style=\"text-align:right;\"> 0.170 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.581 </td>\n   <td style=\"text-align:right;\"> 0.154 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.146 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.608 </td>\n   <td style=\"text-align:right;\"> 0.172 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.153 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.598 </td>\n   <td style=\"text-align:right;\"> 0.159 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.558 </td>\n   <td style=\"text-align:right;\"> 0.142 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.594 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.516 </td>\n   <td style=\"text-align:right;\"> 0.080 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.499 </td>\n   <td style=\"text-align:right;\"> 0.067 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.488 </td>\n   <td style=\"text-align:right;\"> 0.065 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.563 </td>\n   <td style=\"text-align:right;\"> 0.100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.486 </td>\n   <td style=\"text-align:right;\"> 0.076 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.516 </td>\n   <td style=\"text-align:right;\"> 0.074 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.487 </td>\n   <td style=\"text-align:right;\"> 0.064 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### TPR & FPR\n\n\n\n::: {#tbl-tpr-0 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-tpr-0\n\nd_0 |> \n  group_by(method) |> \n  summarise(covs_tpr_mean = sprintf(\"%.3f\", mean(covs_tpr)),\n            .groups = \"drop\") |> \n  kbl(caption = \"TPR, b_x = 0\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>TPR, b_x = 0</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> covs_tpr_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:left;\"> 1.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:left;\"> 0.496 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:left;\"> 0.947 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:left;\"> 0.945 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:left;\"> 0.643 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:left;\"> 0.641 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:left;\"> 0.888 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:left;\"> 0.888 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#cell-fig-tpr-0 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-tpr-0\n\nd_0 |> \n  mutate(n_good_covs = n_covs * p_good_covs) |> \n  group_by(method, n_good_covs) |> \n  summarise(covs_tpr_mean = mean(covs_tpr),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_good_covs, y = covs_tpr_mean, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15)) +\n  labs(y = \"True Positive Rate\",\n       title = \"TPR by n_good_covs, b_x = 0\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-tpr-0-1.png){#fig-tpr-0 width=672}\n:::\n:::\n\n::: {#tbl-tpr-02 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-tpr-02\n\nd_02 |> \n  group_by(method) |> \n  summarise(covs_tpr_mean = sprintf(\"%.3f\", mean(covs_tpr)),\n            .groups = \"drop\") |> \n  kbl(caption = \"TPR, b_x = 0.2\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>TPR, b_x = 0.2</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> covs_tpr_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:left;\"> 1.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:left;\"> 0.596 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:left;\"> 0.946 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:left;\"> 0.945 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:left;\"> 0.639 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:left;\"> 0.641 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:left;\"> 0.886 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:left;\"> 0.888 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#cell-fig-tpr-02 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-tpr-02\n\nd_02 |> \n  mutate(n_good_covs = n_covs * p_good_covs) |> \n  group_by(method, n_good_covs) |> \n  summarise(covs_tpr_mean = mean(covs_tpr),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_good_covs, y = covs_tpr_mean, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15)) +\n  labs(y = \"True Positive Rate\",\n       title = \"TPR by n_good_covs, b_x = 0.2\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-tpr-02-1.png){#fig-tpr-02 width=672}\n:::\n:::\n\n::: {#tbl-tpr-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-tpr-05\n\nd_05 |> \n  group_by(method) |> \n  summarise(covs_tpr_mean = sprintf(\"%.3f\", mean(covs_tpr)),\n            .groups = \"drop\") |> \n  kbl(caption = \"TPR, b_x = 0.5\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>TPR, b_x = 0.5</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> covs_tpr_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:left;\"> 1.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:left;\"> 0.747 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:left;\"> 0.940 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:left;\"> 0.945 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:left;\"> 0.620 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:left;\"> 0.641 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:left;\"> 0.877 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:left;\"> 0.888 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#cell-fig-tpr-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-tpr-05\n\nd_05 |> \n  mutate(n_good_covs = n_covs * p_good_covs) |> \n  group_by(method, n_good_covs) |> \n  summarise(covs_tpr_mean = mean(covs_tpr),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_good_covs, y = covs_tpr_mean, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15)) +\n  labs(y = \"True Positive Rate\",\n       title = \"TPR by n_good_covs, b_x = 0.5\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-tpr-05-1.png){#fig-tpr-05 width=672}\n:::\n:::\n\n::: {#tbl-fpr-0 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-fpr-0\n\nd_0 |> \n  group_by(method) |> \n  summarise(covs_fpr_mean = sprintf(\"%.3f\", mean(covs_fpr)),\n            .groups = \"drop\") |> \n  kbl(caption = \"FPR, b_x = 0\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>FPR, b_x = 0</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> covs_fpr_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:left;\"> 1.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:left;\"> 0.466 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:left;\"> 0.310 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:left;\"> 0.313 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#cell-fig-fpr-0 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-fpr-0\n\nd_0 |> \n  mutate(n_good_covs = n_covs * p_good_covs) |> \n  group_by(method, n_good_covs) |> \n  summarise(covs_fpr_mean = mean(covs_fpr),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_good_covs, y = covs_fpr_mean, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15)) +\n  labs(y = \"False Positive Rate\",\n       title = \"FPR by n_good_covs, b_x = 0\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-fpr-0-1.png){#fig-fpr-0 width=672}\n:::\n:::\n\n::: {#tbl-fpr-02 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-fpr-02\n\nd_02 |> \n  group_by(method) |> \n  summarise(covs_fpr_mean = sprintf(\"%.3f\", mean(covs_fpr)),\n            .groups = \"drop\") |> \n  kbl(caption = \"FPR, b_x = 0.2\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>FPR, b_x = 0.2</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> covs_fpr_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:left;\"> 1.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:left;\"> 0.437 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:left;\"> 0.309 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:left;\"> 0.313 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#cell-fig-fpr-02 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-fpr-02\n\nd_02 |> \n  mutate(n_good_covs = n_covs * p_good_covs) |> \n  group_by(method, n_good_covs) |> \n  summarise(covs_fpr_mean = mean(covs_fpr),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_good_covs, y = covs_fpr_mean, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15)) +\n  labs(y = \"False Positive Rate\",\n       title = \"FPR by n_good_covs, b_x = 0.2\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-fpr-02-1.png){#fig-fpr-02 width=672}\n:::\n:::\n\n::: {#tbl-fpr-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: tbl-fpr-05\n\nd_05 |> \n  group_by(method) |> \n  summarise(covs_fpr_mean = sprintf(\"%.3f\", mean(covs_fpr)),\n            .groups = \"drop\") |> \n  kbl(caption = \"FPR, b_x = 0.5\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>FPR, b_x = 0.5</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> covs_fpr_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> No covariates </td>\n   <td style=\"text-align:left;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates </td>\n   <td style=\"text-align:left;\"> 1.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-hacking </td>\n   <td style=\"text-align:left;\"> 0.375 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Single covariate lm </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Single covariate lm with X </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates lm </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates lm with X </td>\n   <td style=\"text-align:left;\"> 0.050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates LASSO </td>\n   <td style=\"text-align:left;\"> 0.304 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> All covariates LASSO with X </td>\n   <td style=\"text-align:left;\"> 0.313 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#cell-fig-fpr-05 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-fpr-05\n\nd_05 |> \n  mutate(n_good_covs = n_covs * p_good_covs) |> \n  group_by(method, n_good_covs) |> \n  summarise(covs_fpr_mean = mean(covs_fpr),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_good_covs, y = covs_fpr_mean, color = method, linetype = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15)) +\n  labs(y = \"False Positive Rate\",\n       title = \"FPR by n_good_covs, b_x = 0.5\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors)\n```\n\n::: {.cell-output-display}\n![](supplement_files/figure-html/fig-fpr-05-1.png){#fig-fpr-05 width=672}\n:::\n:::\n\n\n\n### Parameter Estimates\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nest_d_0 <- d_0 |> \n  ggplot(aes(x = estimate, color = method, linetype = method)) +\n  geom_density(alpha = 0.5) +\n  geom_vline(xintercept = 0, linetype = \"dotted\", color = \"black\") +\n  scale_x_continuous(limits = c(-0.5, 0.5), breaks = seq(-0.5, 0.5, by = 0.5)) +\n  labs(y = \"Density\",\n       x = \"Estimate\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) \n\nest_d_02 <- d_02 |> \n  filter(method != \"p-hacking\") |> \n  ggplot(aes(x = estimate, color = method, linetype = method)) +\n  geom_density(alpha = 0.5) +\n  geom_vline(xintercept = 0.2, linetype = \"dotted\") +\n  scale_x_continuous(limits = c(-0.2, 0.8), breaks = c(0, 0.2, 0.6)) +\n  labs(y = \"Density\",\n       x = \"Estimate\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) +\n  theme(legend.position = \"none\")\n\nest_d_05 <- d_05 |> \n  filter(method != \"p-hacking\") |> \n  ggplot(aes(x = estimate, color = method, linetype = method)) +\n  geom_density(alpha = 0.5) +\n  geom_vline(xintercept = 0.5, linetype = \"dotted\") +\n  scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.5, 1)) +\n  labs(y = \"Density\",\n       x = \"Estimate\") + \n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) +\n  theme(legend.position = \"none\")\n```\n:::\n\n::: {#cell-fig-distribution-bx .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-distribution-bx\n#| fig-cap: \"Sampling Distribution for Population Parameter Estimates.\"\n#| fig-height: 8\n\nest_d_0 / est_d_02 / est_d_05 \n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 798111 rows containing non-finite outside the scale range\n(`stat_density()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 784215 rows containing non-finite outside the scale range\n(`stat_density()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 529644 rows containing non-finite outside the scale range\n(`stat_density()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Sampling Distribution for Population Parameter Estimates.](supplement_files/figure-html/fig-distribution-bx-1.png){#fig-distribution-bx width=672}\n:::\n:::\n",
    "supporting": [
      "supplement_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}