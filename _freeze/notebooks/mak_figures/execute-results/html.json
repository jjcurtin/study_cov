{
  "hash": "2bae6d2ea34e086e31fe4f083a6cb1e1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Make Figures for Main Manuscript\"\nauthor: \"Lauren Khoury and Kendra Wyant\"\ndate: \"2025-11-14\"\nnumber-sections: true\noutput: \n  html_document:\n    toc: true \n    toc_depth: 4\nformat:\n  html:\n    embed-resources: true\n    toc: true\n    toc-depth: 4\neditor_options: \n  chunk_output_type: console\nexecute:\n  echo: false\nhtml-table-processing: none\n---\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(dplyr) |> suppressMessages()\nlibrary(skimr)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'skimr' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(purrr)\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'ggplot2' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(patchwork)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'patchwork' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(ggpattern)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'ggpattern' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\nlibrary(forcats)\nlibrary(kableExtra, exclude = (\"group_rows\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'kableExtra' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: set up\n\ntheme_set(theme_classic())\n\n\n\nmethod_colors <- c(\"No covariates\" = \"#9E5900\",\n                   \"All covariates\" = \"#E8BE6D\",\n                   \"p-hacking\" = \"#C92C04\",\n                   \"Single covariate lm\" = \"#5489BA\",\n                   \"Single covariate lm with X\" = \"#5489BA\",\n                   \"All covariates lm\" = \"#664896\",\n                   \"All covariates lm with X\" = \"#664896\",\n                   \"All covariates LASSO\" = \"#4A7C59\",\n                   \"All covariates LASSO with X\" = \"#4A7C59\")\n\n\nmethod_linetypes <- c(\"No covariates\" = \"solid\",\n                     \"All covariates\" = \"solid\",\n                     \"p-hacking\" = \"solid\",\n                     \"Single covariate lm\" = \"dashed\",\n                     \"Single covariate lm with X\" = \"solid\",\n                     \"All covariates lm\" = \"dashed\",\n                     \"All covariates lm with X\" = \"solid\",\n                     \"All covariates LASSO\" = \"dashed\",\n                     \"All covariates LASSO with X\" = \"solid\")\n\nmethod_linewidths <- c(\"No covariates\" = .3,\n                     \"All covariates\" = .3,\n                     \"p-hacking\" = .5,\n                     \"Single covariate lm\" = .5,\n                     \"Single covariate lm with X\" = .5,\n                     \"All covariates lm\" = .5,\n                     \"All covariates lm with X\" = .5,\n                     \"All covariates LASSO\" = .5,\n                     \"All covariates LASSO with X\" = .5)\n\nmethod_patterns <- c(\"No covariates\" = \"none\",\n                     \"All covariates\" = \"none\",\n                     \"p-hacking\" = \"none\",\n                     \"Single covariate lm\" = \"stripe\",\n                     \"Single covariate lm with X\" = \"none\",\n                     \"All covariates lm\" = \"stripe\",\n                     \"All covariates lm with X\" = \"none\",\n                     \"All covariates LASSO\" = \"stripe\",\n                     \"All covariates LASSO with X\" = \"none\")\n\ndevtools::source_url(\"https://github.com/jjcurtin/lab_support/blob/main/format_path.R?raw=true\") |> suppressMessages()\n\nrdrive_path <- format_path(\"cov/raw_data\")\n\noptions(digits = 3)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: read in data\n\nd_0 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_method_0.csv\"))\nd_03 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_method_03.csv\"))\nd_05 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_method_05.csv\"))\n\nd_20_covs <- data.table::fread(here::here(rdrive_path, \"batch_results_20_covs.csv\"))\nd_n50 <- data.table::fread(here::here(rdrive_path, \"batch_results_n50.csv\"))\n\nd2_0 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_20K_0.csv\"))\nd2_03 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_20K_03.csv\"))\nd2_05 <- data.table::fread(here::here(rdrive_path, \"batch_results_new_20K_05.csv\"))\n\nd_wo_x_og <- data.table::fread(here::here(rdrive_path, \"batch_results_methods_wo_x_og_seed.csv\"))\nd_wo_x_new <- data.table::fread(here::here(rdrive_path, \"batch_results_methods_wo_x_new_seed.csv\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: combine data\n\nd_0 <- rbind(d_0, d_20_covs |> filter(b_x == 0))\nd_03 <- rbind(d_03, d_20_covs |> filter(b_x == 0.3))\nd_05 <- rbind(d_05, d_20_covs |> filter(b_x == 0.5))\n\nd_0 <- rbind(d_0, d_n50 |> filter(b_x == 0))\nd_03 <- rbind(d_03, d_n50 |> filter(b_x == 0.3))\nd_05 <- rbind(d_05, d_n50 |> filter(b_x == 0.5))\n\nd_0 <- rbind(d_0, d2_0)\nd_03 <- rbind(d_03, d2_03)\nd_05 <- rbind(d_05, d2_05)\n\nd_0 <- rbind(d_0, d_wo_x_og |> filter(b_x == 0))\nd_0 <- rbind(d_0, d_wo_x_new |> filter(b_x == 0))\nd_03 <- rbind(d_03, d_wo_x_og |> filter(b_x == 0.3))\nd_03 <- rbind(d_03, d_wo_x_new |> filter(b_x == 0.3))\nd_05 <- rbind(d_05, d_wo_x_og |> filter(b_x == 0.5))\nd_05 <- rbind(d_05, d_wo_x_new |> filter(b_x == 0.5))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nrm(d_20_covs, d_n50, d2_0, d2_03, d2_05, d_wo_x_og, d_wo_x_new)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: factor levels\n\nd_0 <- d_0 |> \n  mutate(method = factor(method, levels = c(\"p_hacked\", \"no_covs\", \"all_covs\", \"r\",\n                                            \"partial_r\", \"full_lm_wo_x\", \"full_lm\",  \n                                           \"lasso_wo_x\", \"lasso\"),\n                         labels = c(\"p-hacking\", \"No covariates\", \"All covariates\", \n                                    \"Single covariate lm\", \"Single covariate lm with X\", \n                                    \"All covariates lm\", \"All covariates lm with X\", \n                                            \"All covariates LASSO\", \"All covariates LASSO with X\")))\n\nd_03 <- d_03 |> \n  mutate(method = factor(method, levels = c(\"p_hacked\", \"no_covs\", \"all_covs\",  \"r\", \n                                            \"partial_r\", \"full_lm_wo_x\", \"full_lm\",  \n                                           \"lasso_wo_x\", \"lasso\"),\n                         labels = c(\"p-hacking\", \"No covariates\", \"All covariates\", \n                                    \"Single covariate lm\", \"Single covariate lm with X\", \n                                    \"All covariates lm\", \"All covariates lm with X\", \n                                            \"All covariates LASSO\", \"All covariates LASSO with X\")))\n\nd_05 <- d_05 |> \n  mutate(method = factor(method, levels = c(\"p_hacked\", \"no_covs\", \"all_covs\",  \"r\", \n                                            \"partial_r\", \"full_lm_wo_x\", \"full_lm\",  \n                                           \"lasso_wo_x\", \"lasso\"),\n                         labels = c(\"p-hacking\", \"No covariates\", \"All covariates\", \n                                    \"Single covariate lm\", \"Single covariate lm with X\", \n                                    \"All covariates lm\", \"All covariates lm with X\", \n                                            \"All covariates LASSO\", \"All covariates LASSO with X\")))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ntype_I_summary <- d_0 |>\n  group_by(method) |>\n  summarise(type_I = mean(p_value < 0.05)) |> \n  mutate(group = case_match(method,\n                            \"p-hacking\" ~ \"p-hacking\",\n                            \"No covariates\" ~ \"No selection\",\n                            \"All covariates\" ~ \"No selection\",\n                            \"Single covariate lm\" ~ \"Single covariate lm\",\n                            \"Single covariate lm with X\" ~ \"Single covariate lm\",\n                            \"All covariates lm\" ~ \"All covariates lm\",\n                            \"All covariates lm with X\" ~ \"All covariates lm\",\n                            \"All covariates LASSO\" ~ \"All covariates LASSO\",\n                            \"All covariates LASSO with X\" ~ \"All covariates LASSO\"))\n```\n:::\n\n::: {#cell-fig-bar-1 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-bar-1\n#| fig-cap: \"Type I Error by Method. Average type I error rate across all research contexts is displayed for each method separately by color. Striped shading indicates data-driven selection methods that do not control for X.\"\n\n# ---- Parameters\ngap_after_idx <- c(1, 3, 5, 7)  \ngap_size <- 0.2                \nbar_width <- 0.9                \n\n\ndf <- type_I_summary |>\n  mutate(method = fct_relevel(method, \"p-hacking\")) |>\n  mutate(method_chr = as.character(method))\n\n\nn <- nrow(df)\nbase_pos <- seq_len(n)  \n\n# compute how many gaps precede each bar\ngap_count_before <- sapply(base_pos, function(i) sum(gap_after_idx < i))\n# add the total gap length before each bar\nx_pos <- base_pos + gap_count_before * gap_size\n\nplot_df <- df |>\n  mutate(x_pos = x_pos)\n\n\nx_breaks <- plot_df$x_pos\nx_labels <- plot_df$method_chr\n\n\nggplot(\n  plot_df,\n  aes(x = x_pos, y = type_I, fill = method, pattern = method)\n) +\n  geom_bar_pattern(\n    stat = \"identity\",\n    width = bar_width,\n    pattern_colour = \"white\",\n    pattern_fill = \"white\",\n    pattern_angle = 45,\n    pattern_density = 0.3,\n    pattern_size = 0.1,\n    pattern_spacing = 0.03,\n    color = \"black\"\n  ) +\n  geom_text(\n    aes(label = sprintf(\"%.3f\", type_I)),\n    vjust = -0.5\n  ) +\n  labs(x = NULL, y = \"Type I Error\") +\n  scale_y_continuous(\n    limits = c(0, max(type_I_summary$type_I) * 1.2),\n    breaks = seq(0, max(type_I_summary$type_I) * 1.2, by = 0.05)\n  ) +\n  # numeric x with custom breaks/labels; gaps are just extra space between positions\n  scale_x_continuous(\n    breaks = x_breaks,\n    labels = x_labels,\n    expand = expansion(mult = c(0.02, 0.05))  # trim extra margin if you like\n  ) +\n  scale_pattern_manual(values = method_patterns) +\n  scale_fill_manual(values = method_colors) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"none\"\n  )\n```\n\n::: {.cell-output-display}\n![Type I Error by Method. Average type I error rate across all research contexts is displayed for each method separately by color. Striped shading indicates data-driven selection methods that do not control for X.](mak_figures_files/figure-html/fig-bar-1-1.png){#fig-bar-1 width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nobservations <- d_0 |> \n  group_by(method, n_obs) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_obs, y = prop_sig, color = method, linetype = method,\n             linewidth = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(50, 100, 150, 200, 300, 400)) +\n  scale_y_continuous(breaks = c(0.05, 0.10, 0.15, 0.20, .25, .30),\n                     limits = c(0.03, .30)) +\n  labs(x = NULL,\n       subtitle = \"Number of Observations\",\n       y = \"Type I Error\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_linewidth_manual(values = method_linewidths) +\n  scale_color_manual(values = method_colors) +\n  theme(legend.title = element_blank())\n\n\ncovs <- d_0 |> \n  group_by(method, n_covs) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_covs, y = prop_sig, color = method, linetype = method,\n             linewidth = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(4, 8, 12, 16, 20)) +\n  scale_y_continuous(breaks = c(0.05, 0.10, 0.15, 0.20, 0.25, .30),\n                     limits = c(.03, .30)) +\n  labs(y = NULL,\n       x = NULL,\n       subtitle = \"Number of Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) +\n  scale_linewidth_manual(values = method_linewidths) +\n  theme(legend.title = element_blank())\n\ngood_covs <- d_0 |> \n  group_by(method, p_good_covs) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = p_good_covs, y = prop_sig, color = method, linetype = method, \n             linewidth = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(0.25, 0.50, 0.75)) +\n  scale_y_continuous(breaks = c(0.05, 0.10, 0.15, 0.20, .25, .30), \n                     limits = c(.03, .30)) +\n  labs(y = \"Type I Error\",\n       x = NULL,\n       subtitle = \"Proportion of Good Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) +\n  scale_linewidth_manual(values = method_linewidths) +\n  theme(legend.title = element_blank())\n\nycor <- d_0 |> \n  group_by(method, r_ycov) |> \n  summarise(prop_sig = mean(p_value < 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = r_ycov, y = prop_sig, color = method, linetype = method, \n             linewidth = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(0.3, 0.5)) +\n  scale_y_continuous(breaks = c(0.05, 0.10, 0.15, 0.20, 0.25, 0.30), \n                     limits = c(.03, .30)) +\n  labs(y = NULL,\n       x = NULL,\n       subtitle = \"Y-Covariate Correlation Strength\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) +\n  scale_linewidth_manual(values = method_linewidths) +\n  theme(legend.title = element_blank())\n```\n:::\n\n::: {#cell-fig-type1-panel .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-type1-panel\n#| fig-cap: \"Type I error by method and research context. Plots are paneled by aspects of the research context (number of observations, number of covariates, proportion of good covariates, and Y-covariate correlation strength). Methods are displayed separately by color. Data-driven correlation selection methods that control for X are depicted as dashed lines.\"\n#| fig-height: 6\n#| fig-width: 8\n\n(observations + covs)/(good_covs + ycor) +\n  plot_layout(guides = \"collect\") &\n  theme(legend.position = \"right\")\n```\n\n::: {.cell-output-display}\n![Type I error by method and research context. Plots are paneled by aspects of the research context (number of observations, number of covariates, proportion of good covariates, and Y-covariate correlation strength). Methods are displayed separately by color. Data-driven correlation selection methods that control for X are depicted as dashed lines.](mak_figures_files/figure-html/fig-type1-panel-1.png){#fig-type1-panel width=768}\n:::\n:::\n\n::: {#cell-fig-bar-2 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-bar-2\n#| fig-cap: \"Type II Error by Method. Average type II error rate across all research settings is displayed for each method separately by color. Striped shading indicates data-driven selection methods that do not control for X.\"\n\nd_all <- d_03 |>\n  bind_rows(d_05) |> \n  filter(method != \"p-hacking\")\n\ntype_II_summary <- d_all |> \n  group_by(method) |>\n  summarise(type_II = mean(p_value >= 0.05))\n\n# ---- Parameters\ngap_after_idx <- c(2, 4, 6)  \ngap_size <- 0.2                \nbar_width <- 0.9                \n\n\ndf <- type_II_summary |>\n  mutate(method_chr = as.character(method))\n\n\nn <- nrow(df)\nbase_pos <- seq_len(n)  \n\n# compute how many gaps precede each bar\ngap_count_before <- sapply(base_pos, function(i) sum(gap_after_idx < i))\n# add the total gap length before each bar\nx_pos <- base_pos + gap_count_before * gap_size\n\nplot_df <- df |>\n  mutate(x_pos = x_pos)\n\n\nx_breaks <- plot_df$x_pos\nx_labels <- plot_df$method_chr\n\n\n\nggplot(\n  plot_df,\n  aes(x = x_pos, y = type_II, fill = method, pattern = method)\n) +\n   geom_bar_pattern(\n    stat = \"identity\",\n    width = bar_width,\n    pattern_colour = \"white\",\n    pattern_fill = \"white\",\n    pattern_angle = 45,\n    pattern_density = 0.3,\n    pattern_size = 0.1,\n    pattern_spacing = 0.03,\n    color = \"black\"\n  ) +\n  geom_text(\n    aes(label = sprintf(\"%.3f\", type_II)),\n    vjust = -0.5\n  ) +\n  labs(x = NULL, y = \"Type II Error\") +\n  scale_y_continuous(\n    limits = c(0, max(type_II_summary$type_II) * 1.2),\n    breaks = seq(0, max(type_II_summary$type_II) * 1.2, by = 0.05)\n  ) +\n  # numeric x with custom breaks/labels; gaps are just extra space between positions\n  scale_x_continuous(\n    breaks = x_breaks,\n    labels = x_labels,\n    expand = expansion(mult = c(0.02, 0.05))  # trim extra margin if you like\n  ) +\n  scale_pattern_manual(values = method_patterns) +\n  scale_fill_manual(values = method_colors) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"none\"\n  )\n```\n\n::: {.cell-output-display}\n![Type II Error by Method. Average type II error rate across all research settings is displayed for each method separately by color. Striped shading indicates data-driven selection methods that do not control for X.](mak_figures_files/figure-html/fig-bar-2-1.png){#fig-bar-2 width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nobservations_2 <- d_all |> \n  group_by(method, n_obs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_obs, y = prop_not_sig, color = method, linetype = method, linewidth = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(50, 100, 150, 200, 300, 400)) +\n  scale_y_continuous(breaks = c(0.10, 0.20, .30, .40, .50, .60, .70 ),\n                    limits = c(0.02, .72)) +\n  labs(y = \"Type II Error\",\n       subtitle = \"Number of Observations\",\n       x = NULL) +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) +\n  scale_linewidth_manual(values = method_linewidths) +\n  theme(legend.title = element_blank())\n\ncovs_2 <- d_all |> \n  group_by(method, n_covs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = n_covs, y = prop_not_sig, color = method, linetype = method,\n             linewidth = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(4, 8, 12, 16, 20)) +\n  scale_y_continuous(breaks = c(0.10, 0.20, .30, .40),\n                    limits = c(0.02, .42)) +\n  labs(y = NULL,\n       x = NULL,\n       subtitle = \"Number of Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) +\n  scale_linewidth_manual(values = method_linewidths) +\n  theme(legend.title = element_blank())\n\ngood_covs_2 <- d_all |> \n  group_by(method, p_good_covs) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = p_good_covs, y = prop_not_sig, color = method, linetype = method,\n             linewidth = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(0.25, 0.50, 0.75)) +\n  scale_y_continuous(breaks = c(0.10, 0.20, .30, .40 ),\n                    limits = c(0.02, .42)) +\n  labs(y = \"Type II Error\",\n       x = NULL,\n       subtitle = \"Proportion of Good Covariates\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) +\n  scale_linewidth_manual(values = method_linewidths) +\n  theme(legend.title = element_blank())\n\nycor_2 <- d_all |> \n  group_by(method, r_ycov) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = r_ycov, y = prop_not_sig, color = method, linetype = method,\n             linewidth = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(0.3, 0.5)) +\n  scale_y_continuous(breaks = c(0.10, 0.20, .30, .40),\n                    limits = c(0.02, .42)) +\n  labs(y = NULL,\n       x = NULL,\n       subtitle = \"Y-Covariate Correlation Strength\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_linewidth_manual(values = method_linewidths) +\n  scale_color_manual(values = method_colors) +\n  theme(legend.title = element_blank())\n\nb_x <- d_all |> \n  group_by(method, b_x) |> \n  summarise(prop_not_sig = mean(p_value >= 0.05),\n            .groups = \"drop\") |> \n  ggplot(aes(x = b_x, y = prop_not_sig, color = method, linetype = method,\n             linewidth = method)) + \n  geom_line() +\n  scale_x_continuous(breaks = c(0.3, 0.5)) +\n  scale_y_continuous(breaks = c(0.10, 0.20, .30, .40, .50),\n                    limits = c(0.02, .52)) +\n  labs(y = \"Type II Error\",\n       x = NULL,\n       subtitle = \"Population Parameter for X\") +\n  scale_linetype_manual(values = method_linetypes) +\n  scale_color_manual(values = method_colors) +\n  scale_linewidth_manual(values = method_linewidths) +\n  theme(legend.title = element_blank(),\n        legend.position = \"none\")\n```\n:::\n\n::: {#cell-fig-panel-2 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-panel-2\n#| fig-cap: \"Type II error by method and research context. Plots are paneled by aspects of the research context (number of observations, number of covariates, proportion of good covariates, and Y-covariate correlation strength, and population parameter for X). Methods are displayed separately by color. Data-driven correlation selection methods that control for X are depicted as dashed lines.\"\n#| fig-height: 9\n#| fig-width: 7.5\n\n(observations_2 + covs_2)/(good_covs_2 + ycor_2)/(b_x + plot_spacer()) +\n  plot_layout(guides = \"collect\") &\n  theme(legend.position = \"right\")\n```\n\n::: {.cell-output-display}\n![Type II error by method and research context. Plots are paneled by aspects of the research context (number of observations, number of covariates, proportion of good covariates, and Y-covariate correlation strength, and population parameter for X). Methods are displayed separately by color. Data-driven correlation selection methods that control for X are depicted as dashed lines.](mak_figures_files/figure-html/fig-panel-2-1.png){#fig-panel-2 width=720}\n:::\n:::\n",
    "supporting": [
      "mak_figures_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}