<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lauren Khoury">
<meta name="author" content="Kendra Wyant">
<meta name="author" content="John J. Curtin">
<meta name="dcterms.date" content="2025-10-15">

<title>Evaluating Methods for Covariate Selection</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a1ff8711b79ae3724c050874b28d9907.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="citation_title" content="Evaluating Methods for Covariate Selection">
<meta name="citation_abstract" content="Abstract of paper goes here and can span several lines.
">
<meta name="citation_author" content="Lauren Khoury">
<meta name="citation_author" content="Kendra Wyant">
<meta name="citation_author" content="John J. Curtin">
<meta name="citation_publication_date" content="2025-10-15">
<meta name="citation_cover_date" content="2025-10-15">
<meta name="citation_year" content="2025">
<meta name="citation_online_date" content="2025-10-15">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Power failure: Why small sample size undermines the reliability of neuroscience;,citation_abstract=A study with low statistical power has a reduced chance of detecting a true effect, but it is less well appreciated that low power also reduces the likelihood that a statistically significant result reflects a true effect. Here, we show that the average statistical power of studies in the neurosciences is very low. The consequences of this include overestimates of effect size and low reproducibility of results. There are also ethical dimensions to this problem, as unreliable research is inefficient and wasteful. Improving reproducibility in neuroscience is a key priority and requires attention to well-established but often ignored methodological principles.;,citation_author=Katherine S. Button;,citation_author=John P. A. Ioannidis;,citation_author=Claire Mokrysz;,citation_author=Brian A. Nosek;,citation_author=Jonathan Flint;,citation_author=Emma S. J. Robinson;,citation_author=Marcus R. Munafò;,citation_publication_date=2013-05;,citation_cover_date=2013-05;,citation_year=2013;,citation_issue=5;,citation_doi=10.1038/nrn3475;,citation_issn=1471-003X;,citation_volume=14;,citation_language=en-US;,citation_journal_title=Nature Reviews Neuroscience;">
<meta name="citation_reference" content="citation_title=Center for high throughput computing;,citation_author=Center for High Throughput Computing;,citation_publication_date=2006;,citation_cover_date=2006;,citation_year=2006;,citation_doi=10.21231/GNT1-HW21;,citation_publisher=Center for High Throughput Computing;">
<meta name="citation_reference" content="citation_title=Statistical Power Analysis for the Behavioral Sciences;,citation_abstract=Statistical Power Analysis is a nontechnical guide to power analysis in research planning that provides users of applied statistics with the tools they need for more effective analysis. The Second Edition includes: * a chapter covering power analysis in set correlation and multivariate methods; * a chapter considering effect size, psychometric reliability, and the efficacy of &amp;amp;amp;quot;qualifying&amp;quot; dependent variables and; * expanded power and sample size tables for multiple regression/correlation.;,citation_author=Jacob Cohen;,citation_publication_date=1988-07;,citation_cover_date=1988-07;,citation_year=1988;,citation_isbn=978-0-8058-0283-2;,citation_language=en-US;">
<meta name="citation_reference" content="citation_title=False-positive psychology: Undisclosed flexibility in data collection and analysis allows presenting anything as significant;,citation_abstract=In this article, we accomplish two things. First, we show that despite empirical psychologists’ nominal endorsement of a low rate of false-positive findings ($\leq$ .05), flexibility in data collection, analysis, and reporting dramatically increases actual false-positive rates. In many cases, a researcher is more likely to falsely find evidence that an effect exists than to correctly find evidence that it does not. We present computer simulations and a pair of actual experiments that demonstrate how unacceptably easy it is to accumulate (and report) statistically significant evidence for a false hypothesis. Second, we suggest a simple, low-cost, and straightforwardly effective disclosure-based solution to this problem. The solution involves six concrete requirements for authors and four guidelines for reviewers, all of which impose a minimal burden on the publication process.;,citation_author=Joseph P. Simmons;,citation_author=Leif D. Nelson;,citation_author=Uri Simonsohn;,citation_publication_date=2011-11;,citation_cover_date=2011-11;,citation_year=2011;,citation_issue=11;,citation_doi=10.1177/0956797611417632;,citation_issn=1467-9280;,citation_pmid=22006061;,citation_volume=22;,citation_language=en-US;,citation_journal_title=Psychological Science;">
<meta name="citation_reference" content="citation_title=P-Curve and Effect Size: Correcting for Publication Bias Using Only Significant Results;,citation_author=Uri Simonsohn;,citation_author=Leif D. Nelson;,citation_author=Joseph P. Simmons;,citation_publication_date=2014-11;,citation_cover_date=2014-11;,citation_year=2014;,citation_issue=6;,citation_doi=10.1177/1745691614553988;,citation_volume=9;,citation_journal_title=Perspectives on Psychological Science;">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Evaluating Methods for Covariate Selection</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Authors</div>
          <div class="quarto-title-meta-heading">Affiliation</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Lauren Khoury </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Department of Psychology, University of Wisconsin-Madison
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Kendra Wyant </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Department of Psychology, University of Wisconsin-Madison
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">John J. Curtin <a href="mailto:jjcurtin@wisc.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Department of Psychology, University of Wisconsin-Madison
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">October 15, 2025</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      <div class="quarto-alternate-formats"><div class="quarto-title-meta-heading">Other Formats</div><div class="quarto-title-meta-contents"><p><a href="index.docx"><i class="bi bi-file-word"></i>MS Word</a></p></div></div></div>
    </div>

    <div>
      <div class="abstract">
        <div class="block-title">Abstract</div>
        <p>Abstract of paper goes here and can span several lines.</p>
      </div>
    </div>


    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">1</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">2</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2">3</a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3">4</a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4">5</a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5">6</a></li>
  </ul></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul class="collapse">
  <li><a href="#covariate-selection-methods" id="toc-covariate-selection-methods" class="nav-link" data-scroll-target="#covariate-selection-methods">Covariate Selection Methods</a></li>
  <li><a href="#research-settings" id="toc-research-settings" class="nav-link" data-scroll-target="#research-settings">Research Settings</a></li>
  <li><a href="#data-analytic-plan" id="toc-data-analytic-plan" class="nav-link" data-scroll-target="#data-analytic-plan">Data Analytic Plan</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul class="collapse">
  <li><a href="#type-i-error" id="toc-type-i-error" class="nav-link" data-scroll-target="#type-i-error">Type I Error</a>
  <ul class="collapse">
  <li><a href="#by-research-settings" id="toc-by-research-settings" class="nav-link" data-scroll-target="#by-research-settings">By Research Settings</a></li>
  </ul></li>
  <li><a href="#parameter-estimates" id="toc-parameter-estimates" class="nav-link" data-scroll-target="#parameter-estimates">Parameter Estimates</a></li>
  <li><a href="#type-ii-error" id="toc-type-ii-error" class="nav-link" data-scroll-target="#type-ii-error">Type II Error</a>
  <ul class="collapse">
  <li><a href="#by-research-settings-1" id="toc-by-research-settings-1" class="nav-link" data-scroll-target="#by-research-settings-1">By Research Settings</a></li>
  </ul></li>
  <li><a href="#parameter-estimates-1" id="toc-parameter-estimates-1" class="nav-link" data-scroll-target="#parameter-estimates-1">Parameter Estimates</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="quarto-alternate-notebooks"><h2>Notebooks</h2><ul><li><a href="notebooks\mak_figures-preview.html"><i class="bi bi-journal-code"></i>Make Figures for Main Manuscript</a></li><li><a href="notebooks\mak_tables-preview.html"><i class="bi bi-journal-code"></i>Make Tables for Main Manuscript</a></li><li><a href="notebooks\supplement-preview.html"><i class="bi bi-journal-code"></i>Supplemental Material</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  


<section id="introduction" class="level1">
<h1>Introduction</h1>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">1</h2>
<p>We are often interested in experimental manipulations in Psychology. - Namely, to test if a focal variable has a significant effect on an outcome variable of interest. (give simple example)</p>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">2</h2>
<!--Introduce type 2 error-->
<p>We all know that power is important (frame in terms of type 2 error). - low powered studies don’t replicate well (Cohen, replication crisis) - Statistical power is the ability to find a significant effect when one truly does exist. Studies with low power do not replicate well, which led to a replication crisis and an increased awareness of false-positive results. - Type 2 error rate is positively correlated with the “likelihood that a nominally statistically significant finding actually reflects a true effect” - “problems with low power when all other research practices are ideal: low probability of finding true effects, low ppv when an effect is claimed, and exaggerated estimate of the magnitude of the effect when a true effect is discovered (Effect inflation is worst for small, low-powered studies, which can only detect effects that happen to be large.)” (PPV is the probability that a ‘positive’ research finding reflects a true effect (that is, the finding is a true positive)). - statistical power definition - “The statistical power of a test is the probability that it will correctly reject the null hypothesis when the null hypothesis is false (that is, the probability of not committing a type II error or making a false negative decision). The probability of committing a type II error is referred to as the false negative rate (β), and power is equal to 1 – β.”</p>
<p>statistical power citations - <span class="citation" data-cites="cohenStatisticalPowerAnalysis1988 cohenPowerPrimer1992">(<a href="#ref-cohenStatisticalPowerAnalysis1988" role="doc-biblioref">Cohen 1988</a>; <a href="#ref-cohenPowerPrimer1992" role="doc-biblioref"><strong>cohenPowerPrimer1992?</strong></a>)</span></p>
<p><span class="citation" data-cites="buttonPowerFailureWhy2013">(<a href="#ref-buttonPowerFailureWhy2013" role="doc-biblioref">Button et al. 2013</a>)</span> - shows the average statistical power of studies in neuroscience is very low, causing overestimates of effect sizes and low reproducibility of results. They also raise ethical concern that unreliable research is inefficient and wasteful.</p>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2">3</h2>
<p>Covariates (measured at baseline before manipulation) to increase power (classic cites?) - keep type 2 error rate down. - Covariates are variables that do not have focal hypotheses, but are added to increase statistical power and model precision of the focal parameter estimate. - They explain some of the variance that might otherwise show up as noise. - Including covariates increases detection of true effects of the manipulated variable of focus. For example, if researchers were testing the effects of a new treatment technique on depression, variables such as age, sex, gender identity, socioeconomic status, and education could be measured at baseline and included in the model as covariates. (continue earlier example with covariates added that intuitively might be related to outcome) This would increase power to find if there is a true significant effect of the new treatment on depression. This increase in power comes from a reduction in the error of the model as covariates account for more unexplained variance in the outcome. This reduces the standard error of the <span class="math inline">\(X\)</span> effect which yields a more precise parameter estimate.</p>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3">4</h2>
<!--introduce type 1 error-->
<p>Evidence that p-hacking is problematic (Simons) - Previously, it was common practice to test multiple statistical analyses until statistical significance was reached with only the significant result being reported <span class="citation" data-cites="simmonsFalsepositivePsychologyUndisclosed2011">(<a href="#ref-simmonsFalsepositivePsychologyUndisclosed2011" role="doc-biblioref">Simmons, Nelson, and Simonsohn 2011</a>)</span>. This repeated testing and selective reporting of significant results came to be known as p-hacking <span class="citation" data-cites="urisimonsohnPCurveEffectSize2014">(<a href="#ref-urisimonsohnPCurveEffectSize2014" role="doc-biblioref">Uri Simonsohn, Leif D. Nelson, and Joseph P. Simmons 2014</a>)</span>. This led to an increase in “false-positive psychology” where researchers were finding significant effects that did not truly exist. This was motivated by two factors: an inherent publication bias of journals to only publish significant results, leading to researchers striving to reach this result and an ambiguity in decision-making <span class="citation" data-cites="simmonsFalsepositivePsychologyUndisclosed2011">(<a href="#ref-simmonsFalsepositivePsychologyUndisclosed2011" role="doc-biblioref">Simmons, Nelson, and Simonsohn 2011</a>)</span>. Researchers have various decisions such as sample size of the study, handling of outliers, and including covariates in linear models. There are not always clear guidelines on how to make these decisions.</p>
<p>Ioannidis, J.P. Why most published research findings are false. PLoS Med. 2, e124 (2005). - This study demonstrates that many (and possibly most) of the conclusions drawn from biomedical research are probably false. The reasons for this include using flexible study designs and flexible statistical analyses and running small studies with low statistical power.</p>
<p>Simmons, J.P., Nelson, L.D. &amp; Simonsohn,U. False-positive psychology: undisclosed flexibility in data collection and analysis allows presenting anything as significant. Psychol. Sci. 22, 1359–1366 (2011). - This article empirically illustrates that flexible study designs and data analysis dramatically increase the possibility of obtaining a nominally significant result. However, conclusions drawn from these results are almost certainly false.</p>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4">5</h2>
<p>Perhaps shouldn’t use covariates. Though as we mentioned this would come with cost to power/increased type 2 error. Another conclusion might be to use all covs (all variables reasonably believed to account for variance in outcome) - reduces degrees of freedom. - The prevalence of possible covariates to measure in the field of Psychology is high, making it difficult for researchers to know how many and which ones to add to a model. - Some measured covariates may be redundant as they explain overlapping variance in the outcome or they may not be related to the outcome at all. - Ideally, only the “good” covariates should be included in statistical models. “Good” covariates are uncorrelated with the focal independent variable and explain variance in the outcome. In experimental work, covariates are measured at baseline before the manipulation and are, therefore, not correlated with the manipulated variable, so the first part is satisfied. The second part is less trivial and needs further exploration.</p>
</section>
<section id="section-5" class="level2">
<h2 class="anchored" data-anchor-id="section-5">6</h2>
<p>We need a method for selecting covariates that doesn’t nominally change type 1 error rate. - introduce proposed methods - least absolute shrinkage and selection operator (LASSO)</p>
<p>Our research aims to provide clear and accessible methods for researchers to use to select among a set of covariates by simulating … across several research settings.</p>
<p>We replicate that p-hacking is not a statistically valid method and propose eight other methods for selecting covariates. The methods are tested and compared in systematically varied research settings accounting for different effect sizes, sample sizes, amounts of available covariates, proportions of good covariates, and correlations. The methods are compared by their Type I error rates (the probability of rejecting the null hypothesis when no effect exists) and Type II error rates (the probability of failing to reject the null hypothesis when an effect does exist).</p>
</section>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
<section id="covariate-selection-methods" class="level2">
<h2 class="anchored" data-anchor-id="covariate-selection-methods">Covariate Selection Methods</h2>
<!--Think of how we want to refer to the 9 methods, since they are not all covariate selection methods-->
<p>We evaluated nine linear regression models. Two models did not use any covariate selection: a linear regression model that used no covariates and a linear regression model that used all available covariates. One model used a statistically invalid method of selecting covariates based on whether they lower the regression p-value (i.e., p-hacking). The remaining six models used three systematic covariate selection methods, selection based on the Pearson correlation coefficient (<em>r</em>), a full linear model, and LASSO, controlling for the focal manipulation (i.e., <em>X</em>) and without controlling for <em>X</em>.</p>
<p>A summary of the nine models is presented in <a href="#tbl-methods" class="quarto-xref">Table&nbsp;1</a>.</p>
<div class="quarto-embed-nb-cell">
<div class="cell">
<div id="tbl-methods" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-methods-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: The nine linear regression models and their definition for covariate selection.
</figcaption>
<div aria-describedby="tbl-methods-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No covariates</td>
<td style="text-align: left;">$Y$ is regressed on $X$ without any covariates.</td>
</tr>
<tr class="even">
<td style="text-align: left;">All covariates</td>
<td style="text-align: left;">All available covariates are included in the regression model.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">P-hacking</td>
<td style="text-align: left;">Unsystematically adding covariates based on whether they lower the $p$-value of the main effect of $X$ on $Y$.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bivariate correlation</td>
<td style="text-align: left;">Pearson correlation coefficient ($r$) of covariates on $Y$. Covariates are considered one at a time and included in the final model if they yield a significant effect on $Y$ ($p$ &lt; .05).</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Partial correlation</td>
<td style="text-align: left;">Pearson correlation coefficient ($r$) of covariates on $Y$ while controlling for $X$. Covariates are considered one at a time and included in the final model if they yield a significant effect on $Y$ ($p$ &lt; .05).</td>
</tr>
<tr class="even">
<td style="text-align: left;">Full linear model</td>
<td style="text-align: left;">A full linear model that regresses $Y$ on all available covariates. Covariates that have a statistically significant effect on $Y$ ($p$ &lt; .05) are retained.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Full linear model with $X$</td>
<td style="text-align: left;">A full linear model that regresses $Y$ on all available covariates and $X$. Covariates that have a statistically significant effect on $Y$ ($p$ &lt; .05) when controlling for $X$ are retained.</td>
</tr>
<tr class="even">
<td style="text-align: left;">LASSO</td>
<td style="text-align: left;">A linear model that regresses $Y$ on all available covariates and applies a penalty to shrink coefficients for less important covariates, potentially dropping them altogether (i.e., coefficient of 0). Covariates with non-zero coefficients were retained.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LASSO with $X$</td>
<td style="text-align: left;">A linear model that regresses $Y$ on all available covariates and applies a penalty to shrink coefficients for less important covariates. We assigned a 0 penalty to $X$ to retain it in the model. Covariates with non-zero coefficients when controlling for $X$ were retained.</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="research-settings" class="level2">
<h2 class="anchored" data-anchor-id="research-settings">Research Settings</h2>
<!--consider adding citations throughout this section to justify some of our decisions-->
<p>We manipulated several variables designed to mimic varying research settings that psychology researchers might be working in. These include:</p>
<ol type="1">
<li><p><strong>The true population parameter for <em>X</em>.</strong> We selected values that represent null (<span class="math inline">\(b_x = 0\)</span>), medium (<span class="math inline">\(b_x = 0.3\)</span>) and large (<span class="math inline">\(b_x = 0.5\)</span>) effect sizes.</p></li>
<li><p><strong>The sample size.</strong> We chose values for the number of observations that pertain to common sample sizes in experimental research: 50, 100, 150, 200, 300, and 400 observations.</p></li>
<li><p><strong>The number of covariates available.</strong> We selected a wide range of possible scenarios: 4, 8, 12, 16, or 20 covariates.</p></li>
<li><p><strong>The proportion of “good” covariates.</strong> We used varying proportions of good covariates across research settings (.25, .50, and .75) to represent a common reality when a researcher is faced with many covariates, but only some may be related to their outcome.</p></li>
<li><p><strong>The strength of the relationship between the good covariates and <em>Y</em>.</strong> All good covariates were given a moderate and large relationship to <span class="math inline">\(Y\)</span>, correlations of 0.3 and 0.5, respectively. Since these good covariates are all correlated with <span class="math inline">\(Y\)</span>, it is likeley they are also correlated with each other. Therefore we assigned a moderate 0.3 correlation for all relationships among good covariates.</p></li>
</ol>
<p>We crossed all levels of each variable to create a total of 540 unique research settings. A summary of these settings is presented in <a href="#tbl-dictionary" class="quarto-xref">Table&nbsp;2</a>.</p>
<div class="quarto-embed-nb-cell">
<div class="cell">
<div id="tbl-dictionary" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-dictionary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Research setting variables and values
</figcaption>
<div aria-describedby="tbl-dictionary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<table class="table table-striped table-hover do-not-create-environment cell caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Research Setting Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 15em;">The population parameter for $X$</td>
<td style="text-align: left; width: 10em;">0, 0.3, 0.5</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 15em;">The number of observations in the sample</td>
<td style="text-align: left; width: 10em;">50, 100, 150, 200, 300, 400</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 15em;">The number of covariates</td>
<td style="text-align: left; width: 10em;">4, 8, 12, 16, 20</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 15em;">The proportion of "good" covariates</td>
<td style="text-align: left; width: 10em;">0.25, 0.50, 0.75</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 15em;">The correlation between $Y$ and good covariates</td>
<td style="text-align: left; width: 10em;">0.3, 0.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="data-analytic-plan" class="level2">
<h2 class="anchored" data-anchor-id="data-analytic-plan">Data Analytic Plan</h2>
<p>All data analyses were done in R (version 4.4.2). Simulations were run using high-throughput computing resources provided by the University of Wisconsin-Madison Center for High Throughput Computing <span class="citation" data-cites="chtc">(<a href="#ref-chtc" role="doc-biblioref">Center for High Throughput Computing 2006</a>)</span>.</p>
<p>We ran 40,000 simulations for each research setting. Within each simulation we generated a unique datset that consisted of a dichotomous focal variable (<em>X</em>), varying numbers of quantitative covariates, where a subset are correlated with each other and with <em>Y</em> (see Research Settings section), and a quantitative outcome (<em>Y</em>) calculated by adding the <em>X</em> variable multiplied by the effect size (i.e., population parameter) to the <em>Y</em> generated from the correlation matrix with the covariates. We fit models from our nine methods on each simulated dataset. From each model we saved out the parameter estimate, standard error, and p-value for <span class="math inline">\(X\)</span>. We also calculated true and false positive rates to evaluate the rate at which the model selected covariates correlated with <span class="math inline">\(Y\)</span> (i.e., percentage of good covariates selected) and incorrectly selected covariates not correlated with <span class="math inline">\(Y\)</span> (i.e., percentage of bad covariates selected).</p>
<p>For research settings where the population parameter for <em>X</em> is 0 (i.e., <em>X</em> has no effect on <em>Y</em>), we report the type I error rate for each method both across and within research settings. For research settings where the population parameter for <em>X</em> is 0.3 or 0.5 (i.e., <em>X</em> has an effect on <em>Y</em>), we report the type II error rate for each method across and within research settings. We also provide sampling distributions of the parameter estimate for <em>X</em> across research settings for each method, separately by true effect size (0, 0.3, and 0.5). Detailed tables of range and average error rates for each research setting and true and false positive rates for covariates are available in the supplement.</p>
</section>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<section id="type-i-error" class="level2">
<h2 class="anchored" data-anchor-id="type-i-error">Type I Error</h2>
<p>In the case of a zero <span class="math inline">\(X\)</span> effect, we set the population parameter for <span class="math inline">\(X\)</span> to be zero (i.e., <span class="math inline">\(b_x = 0\)</span>), so that any significant result found is a Type I error. The first comparison will look at selection method overall, aggregated across all research settings. In Figure <span class="citation" data-cites="typeI-bar">(<a href="#ref-typeI-bar" role="doc-biblioref"><strong>typeI-bar?</strong></a>)</span>, the average proportion of significant effects – the Type I error – is calculated and displayed. Refer to the Supplemental Material section to see the distribution of Type I error of each method.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeI-bar" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typei-bar" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typei-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typei-bar-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Type I Error by Method"><img src="index_files/figure-html/notebooks-mak_figures-fig-typei-bar-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typei-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Type I Error by Method
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<!--add to figure legends: Note that for the line plots throughout this report, a solid line will indicate a method that does not involve performing selection of covariates (i.e., using no or all covariates). A dashed line will indicate a method that does involve performing a non-trivial selection of covariates. A dotted black line will indicate the expected value (if applicable). For example, there will be a dotted line at $\alpha = 0.05$, the signifance level considered here and hence, the expected Type I error rate.-->
<p>Previous findings are replicated that using p-hacking for selecting covariates leads to a highly inflated Type I error rate (0.198). The p-hacked model consistently shows high Type I error, as is evident in the remaining figures in this section. Most methods are at the expected 0.050 mark, while the partial correlation approach shows slight inflation (0.052), with both LASSO and full linear model showing further inflation (0.057 and 0.060, respectively). These eight methods (excluding p-hacking) can be considered statistically valid as they show little to no inflation of Type I error rates.</p>
<section id="by-research-settings" class="level3">
<h3 class="anchored" data-anchor-id="by-research-settings">By Research Settings</h3>
<p>This section will consider the Type I error rates across the established values of the research context variables.</p>
<p>Figure <strong>?@fig-typeI-nobs</strong> displays the change in Type I error as the number of observations in a sample increases for all nine methods.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeI-nobs" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typei-nobs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typei-nobs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typei-nobs-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Type I Error by Number of Observations"><img src="index_files/figure-html/notebooks-mak_figures-fig-typei-nobs-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typei-nobs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Type I Error by Number of Observations
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>At the smallest sample size (<span class="math inline">\(n=50\)</span>), the discrepancy between methods is greatest, with partial correlation, LASSO, and full linear model deviating from the expected value of 0.05. However, as sample size increases, all methods become comparable, especially with <span class="math inline">\(n=300\)</span> or larger.</p>
<p>Figure <strong>?@fig-typeI-ncovs</strong> displays the change in Type I error as the number of covariares increases for all nine methods. Recall that the number of covariates refers to the number of available covariates, not necessarily the number included in the final model.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeI-ncovs" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typei-ncovs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typei-ncovs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typei-ncovs-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Type I Error by Number of Covariates"><img src="index_files/figure-html/notebooks-mak_figures-fig-typei-ncovs-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typei-ncovs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Type I Error by Number of Covariates
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>There is a slight increase in Type I error for LASSO and full linear model as the number of covariates increases, while the other methods stay at or around 0.05.</p>
<p>Figure <strong>?@fig-typeI-pgoodcovs</strong> displays the change in Type I error as the proportion of good covariares increases for all nine methods.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeI-pgoodcovs" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typei-pgoodcovs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typei-pgoodcovs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typei-pgoodcovs-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Type I Error by Proportion of Good Covariates"><img src="index_files/figure-html/notebooks-mak_figures-fig-typei-pgoodcovs-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typei-pgoodcovs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Type I Error by Proportion of Good Covariates
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Most of the methods remain stagnant in Type I error as the proportions increase, except the error of LASSO decreases slightly and that of full linear model increases.</p>
<p>Figure <strong>?@fig-typeI-rycov</strong> shows the change in Type I error as the correlation between <span class="math inline">\(Y\)</span> and the good covariates increases for all nine methods. The correlation among the good covariates did not vary, so only the <span class="math inline">\(Y\)</span>-covariate correlation will be compared.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeI-rycov" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typei-rycov" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typei-rycov-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typei-rycov-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Type I Error by Y-Covariate Correlation"><img src="index_files/figure-html/notebooks-mak_figures-fig-typei-rycov-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typei-rycov-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Type I Error by Y-Covariate Correlation
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>All of the valid methods did not see a great change in Type I error as the correlation increased.</p>
</section>
</section>
<section id="parameter-estimates" class="level2">
<h2 class="anchored" data-anchor-id="parameter-estimates">Parameter Estimates</h2>
<p>As mentioned, this section considers a population parameter of <span class="math inline">\(X\)</span> set to zero. Figure <a href="#fig-distribution-bx-0" class="quarto-xref">Figure&nbsp;6</a> shows the sampling distribution for the parameter estimate of <span class="math inline">\(X\)</span> for all nine methods. For further information about the average estimate, see the table in the Supplemental Material section. This table also displays the standard deviation of the estimates from the linear model, the average standard error of the model, and their difference. The standard error of the sampling distribution is expected to match the standard error of the parameter estimates. The table shows a large difference in these values for the p-hacked method and slight differences for LASSO, full linear model, and partial correlation approaches.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-distribution-bx-0" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-distribution-bx-0" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distribution-bx-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-distribution-bx-0-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: Sampling Distribution for b_x=0 Estimate"><img src="index_files/figure-html/notebooks-mak_figures-fig-distribution-bx-0-output-2.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distribution-bx-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Sampling Distribution for b_x=0 Estimate
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>This distribution highlights another negative consequence of p-hacking. While its distribution is still centered around zero, it is not normally distributed around zero, emphasizing a biasing of the parameter estimates. The remaining distributions are centered around zero. The model fit with no covariates has the widest distribution, indicating greater variability in its estimate for the <span class="math inline">\(X\)</span> effect.</p>
</section>
<section id="type-ii-error" class="level2">
<h2 class="anchored" data-anchor-id="type-ii-error">Type II Error</h2>
<p>In the case of a nonzero <span class="math inline">\(X\)</span> effect, we tested two values for the population parameter for <span class="math inline">\(X\)</span>, 0.3 and 0.5 (i.e., <span class="math inline">\(b_x=0.3, b_x=0.5\)</span>), so that any non-significant result found is a Type II error. There is no benchmark of expected Type II error as there was for Type I, so the stronger methods will be those with lower Type II error (implying greater statistical power). As the p-hacked method was established as a method that is not statistically valid, it will not be considered in comparisons of Type II error.</p>
<p>The first comparison will look at selection method overall, aggregated across all research settings, for both effect sizes. In Figure <span class="citation" data-cites="typeII-bar-03">(<a href="#ref-typeII-bar-03" role="doc-biblioref"><strong>typeII-bar-03?</strong></a>)</span> and Figure <span class="citation" data-cites="typeII-bar-05">(<a href="#ref-typeII-bar-05" role="doc-biblioref"><strong>typeII-bar-05?</strong></a>)</span>, the proportion of non-significant effects – the Type II error – is calculated and displayed. See the Supplemental Material section for the distributions of Type II error of each valid method.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeII-bar-03" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typeii-bar-03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typeii-bar-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typeii-bar-03-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;7: Type II Error by Method, b_x=0.3"><img src="index_files/figure-html/notebooks-mak_figures-fig-typeii-bar-03-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typeii-bar-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Type II Error by Method, b_x=0.3
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeII-bar-05" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typeii-bar-05" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typeii-bar-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typeii-bar-05-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;8: Type II Error by Method, b_x=0.5"><img src="index_files/figure-html/notebooks-mak_figures-fig-typeii-bar-05-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typeii-bar-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Type II Error by Method, b_x=0.5
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>For both effect sizes, similar trends are shown. Fitting a model with no covariates results in the highest Type II error. When further examining the error rates within research settings, the no covariates approach will continue to yield the highest Type II error. There is a large reduction in error when all covariates are included in the model instead of no covariates. Additionally, performing selection of these covariates further reduces Type II error from simply including all covariates.</p>
<section id="by-research-settings-1" class="level3">
<h3 class="anchored" data-anchor-id="by-research-settings-1">By Research Settings</h3>
<p>Figure <strong>?@fig-typeII-nobs-03</strong> and Figure <strong>?@fig-typeII-nobs-05</strong> display the change in Type II error as the number of observations in a sample increases for all eight methods.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeII-nobs-03" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typeii-nobs-03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typeii-nobs-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typeii-nobs-03-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;9: Type II Error by Number of Observations, b_x=0.3"><img src="index_files/figure-html/notebooks-mak_figures-fig-typeii-nobs-03-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typeii-nobs-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Type II Error by Number of Observations, b_x=0.3
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeII-nobs-05" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typeii-nobs-05" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typeii-nobs-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typeii-nobs-05-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;10: Type II Error by Number of Observations, b_x=0.5"><img src="index_files/figure-html/notebooks-mak_figures-fig-typeii-nobs-05-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typeii-nobs-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Type II Error by Number of Observations, b_x=0.5
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>At the smallest sample size, the methods differ in Type II error, with LASSO and partial correlation approaches yielding the lowest in both effect size cases. As sample size increases, the seven methods (excluding the no covariates method) tend to become indistinguishable.</p>
<p>Figure <strong>?@fig-typeII-ncovs-03</strong> and Figure <strong>?@fig-typeII-ncovs-05</strong> display the change in Type II error as the number of covariates increases for all eight methods.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeII-ncovs-03" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typeii-ncovs-03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typeii-ncovs-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typeii-ncovs-03-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;11: Type II Error by Number of Covariates, b_x=0.3"><img src="index_files/figure-html/notebooks-mak_figures-fig-typeii-ncovs-03-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typeii-ncovs-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Type II Error by Number of Covariates, b_x=0.3
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeII-ncovs-05" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typeii-ncovs-05" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typeii-ncovs-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typeii-ncovs-05-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;12: Type II Error by Number of Covariates, b_x=0.5"><img src="index_files/figure-html/notebooks-mak_figures-fig-typeii-ncovs-05-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typeii-ncovs-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Type II Error by Number of Covariates, b_x=0.5
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>For the smallest number of covariates, the methods are comparable in Type II error, but for larger numbers of covariates, there is a larger gap in performance. As the number of covariates increases, LASSO begins to have the lowest Type II error, followed by the partial correlation and bivariate correlation approaches. Additionally, the method of including all covariates becomes out-performed by the selection methods.</p>
<p>Figure <strong>?@fig-typeII-pgoodcovs-03</strong> and Figure <strong>?@fig-typeII-pgoodcovs-05</strong> display the change in Type II error as the proportion of good covariates increases for all eight methods.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeII-pgoodcovs-03" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typeii-pgoodcovs-03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typeii-pgoodcovs-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typeii-pgoodcovs-03-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;13: Type II Error by Proportion of Good Covariates, b_x=0.3"><img src="index_files/figure-html/notebooks-mak_figures-fig-typeii-pgoodcovs-03-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typeii-pgoodcovs-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Type II Error by Proportion of Good Covariates, b_x=0.3
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeII-pgoodcovs-05" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typeii-pgoodcovs-05" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typeii-pgoodcovs-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typeii-pgoodcovs-05-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;14: Type II Error by Proportion of Good Covariates, b_x=0.5"><img src="index_files/figure-html/notebooks-mak_figures-fig-typeii-pgoodcovs-05-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typeii-pgoodcovs-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Type II Error by Proportion of Good Covariates, b_x=0.5
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>For higher proportions of good covariates, LASSO, partial correlation, and bivariate correlation have the lowest Type II error.</p>
<p>Figure <strong>?@fig-typeII-rycov-03</strong> and Figure <strong>?@fig-typeII-rycov-05</strong> display the change in Type II error as the correlation between <span class="math inline">\(Y\)</span> and the good covariates increases for all eight methods.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeII-rycov-03" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typeii-rycov-03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typeii-rycov-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typeii-rycov-03-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figure&nbsp;15: Type II Error by Y-Covariate Correlation, b_x=0.3"><img src="index_files/figure-html/notebooks-mak_figures-fig-typeii-rycov-03-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typeii-rycov-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: Type II Error by Y-Covariate Correlation, b_x=0.3
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-typeII-rycov-05" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-typeii-rycov-05" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-typeii-rycov-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-typeii-rycov-05-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Figure&nbsp;16: Type II Error by Y-Covariate Correlation, b_x=0.5"><img src="index_files/figure-html/notebooks-mak_figures-fig-typeii-rycov-05-output-1.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-typeii-rycov-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: Type II Error by Y-Covariate Correlation, b_x=0.5
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>All methods (excluding the no covariates approach) show similar decreasing trends in Type II error as the correlation between <span class="math inline">\(Y\)</span> and the good covariates increases. The differences between these methods are minimal.</p>
</section>
</section>
<section id="parameter-estimates-1" class="level2">
<h2 class="anchored" data-anchor-id="parameter-estimates-1">Parameter Estimates</h2>
<p>As mentioned, this section considers two population parameters of <span class="math inline">\(X\)</span> set to 0.3 and 0.5 Figure <a href="#fig-distribution-bx-03" class="quarto-xref">Figure&nbsp;17</a> and Figure <a href="#fig-distribution-bx-05" class="quarto-xref">Figure&nbsp;18</a> show the sampling distributions for the parameter estimate of <span class="math inline">\(X\)</span> for all eight methods. See the tables in the Supplemental Material section for more information about the average estimates, the standard deviation of the estimates, and the average standard error of the model for both 0.3 and 0.5 effect sizes. The tables show that the bivariate correlation, full linear model without <span class="math inline">\(X\)</span>, and LASSO without <span class="math inline">\(X\)</span> approaches slightly underestimate the parameter estimate.</p>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-distribution-bx-03" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-distribution-bx-03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distribution-bx-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-distribution-bx-03-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Figure&nbsp;17: Sampling Distribution for b_x=0.3 Estimate"><img src="index_files/figure-html/notebooks-mak_figures-fig-distribution-bx-03-output-2.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distribution-bx-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Sampling Distribution for b_x=0.3 Estimate
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-embed-nb-cell">
<div id="cell-fig-distribution-bx-05" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-distribution-bx-05" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distribution-bx-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/notebooks-mak_figures-fig-distribution-bx-05-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Figure&nbsp;18: Sampling Distribution for b_x=0.5 Estimate"><img src="index_files/figure-html/notebooks-mak_figures-fig-distribution-bx-05-output-2.png" width="672" height="480" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distribution-bx-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: Sampling Distribution for b_x=0.5 Estimate
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Both distributions show parameter estimates centered around the population values. In both effect size cases, the method including no covariates has a wider distribution, and therefore, more variability in its parameter estimates.</p>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<p>This present study sought to empirically compare methods for covariate selection in linear models. R scripts were used to generate data, fit linear models, and extract and visualize model results. The data generation process was based on full crossings of levels of variables which were chosen to represent common research settings in Psychology. Within each research setting, a unique dataset was simulated 40,000 times using high-throughput computing, with each dataset being used to fit models according to the nine methods discussed.</p>
<p>The first step in evaluating the nine methods, was to establish which methods are statistically valid (i.e., have a Type I error rate of 0.05). We replicated previous findings that p-hacking is not a statistically valid method as it yielded inflated Type I error rates and biased parameter estimates. The remaining eight methods were found to be statistically valid, although LASSO and full linear model show slight inflation.</p>
<p>With this established, the methods could be further compared by their Type II error rates. Lower Type II error can also be considered as higher statistical power. Including all covariates in a model shows a large reduction in Type II error compared to including no covariates in a model. Thus, researchers are encouraged to measure and use covariates. From there, performing a selection of covariates yields further reductions in Type II error compared to simply using all covariates. Overall, LASSO, partial correlation, and bivariate correlation resulted in the lowest Type II errors. However, there are more factors to take into consideration.</p>
<p>Depending on the research setting, researchers may prefer one method over another. As sample size increases (especially past <span class="math inline">\(n=200\)</span>), the performance of methods tends to become indistinguishable. For the largest number of covariates tested (20), LASSO had the lowest Type II error, but for smaller numbers, it is comparable to partial correlation. LASSO showed more inflation of Type I error than the partial correlation approach which in turn showed more inflation than the bivariate correlation approach. Among these three, LASSO is the most computationally expensive and will come with a steep learning curve for new users. The bivariate correlation approach showed no inflation of Type I error, but underestimated the parameter estimates for the nonzero <span class="math inline">\(X\)</span> effects. The partial correlation approach did have slight inflation of Type I error, but correctly estimated the parameter estimates for the nonzero effects. The partial correlation approach also had lower Type II error than the bivariate correlation approach, overall and within different research contexts. With this information, researchers should consider what to prioritize depending on their goals.</p>
</section>
<section id="references" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-buttonPowerFailureWhy2013" class="csl-entry" role="listitem">
Button, Katherine S., John P. A. Ioannidis, Claire Mokrysz, Brian A. Nosek, Jonathan Flint, Emma S. J. Robinson, and Marcus R. Munafò. 2013. <span>“Power Failure: Why Small Sample Size Undermines the Reliability of Neuroscience.”</span> <em>Nature Reviews Neuroscience</em> 14 (5): 365–76. <a href="https://doi.org/10.1038/nrn3475">https://doi.org/10.1038/nrn3475</a>.
</div>
<div id="ref-chtc" class="csl-entry" role="listitem">
Center for High Throughput Computing. 2006. <span>“Center for High Throughput Computing.”</span> Center for High Throughput Computing. <a href="https://doi.org/10.21231/GNT1-HW21">https://doi.org/10.21231/GNT1-HW21</a>.
</div>
<div id="ref-cohenStatisticalPowerAnalysis1988" class="csl-entry" role="listitem">
Cohen, Jacob. 1988. <em>Statistical <span>Power Analysis</span> for the <span>Behavioral Sciences</span></em>. 2 edition. Hillsdale, N.J: Routledge.
</div>
<div id="ref-simmonsFalsepositivePsychologyUndisclosed2011" class="csl-entry" role="listitem">
Simmons, Joseph P., Leif D. Nelson, and Uri Simonsohn. 2011. <span>“False-Positive Psychology: Undisclosed Flexibility in Data Collection and Analysis Allows Presenting Anything as Significant.”</span> <em>Psychological Science</em> 22 (11): 1359–66. <a href="https://doi.org/10.1177/0956797611417632">https://doi.org/10.1177/0956797611417632</a>.
</div>
<div id="ref-urisimonsohnPCurveEffectSize2014" class="csl-entry" role="listitem">
Uri Simonsohn, Leif D. Nelson, and Joseph P. Simmons. 2014. <span>“P-<span>Curve</span> and <span>Effect Size</span>: <span>Correcting</span> for <span>Publication Bias Using Only Significant Results</span>.”</span> <em>Perspectives on Psychological Science</em> 9 (6): 666–81. <a href="https://doi.org/10.1177/1745691614553988">https://doi.org/10.1177/1745691614553988</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>